\subsection{More Examples Demonstrating the Expressiveness of \Nec}
% do not say \Nec Specifications
% because it is language that is expressive, not the specification
\label{s:expressiveness}

In this section we discuss some further specification examples, and use them to elucidate finer points
in the semantics of \Nec. We also  discuss which modules    satisfy  which specifications.

 \subsubsection{More examples of the Bank}
Looking back at the example from the Section \ref{s:outline},   it holds that
\\
\strut % $\hspace{.6in}$ \ModA$\vDash$ \SrobustB
 % \\ \strut 
 $\hspace{.6in}$ \ModB$\nvDash$ \SrobustB
  $\hspace{.6in}$ \ModC$\vDash$ \SrobustB
 
\sophiaPonder[renamed the specs, check corretcness]{}
 
% SD dropped the below -- not that useful
% For more specification examples, consider the
%bank account discussed in Section \ref{s:intro}. We have already shown
%how we can specify knowledge of an account's password using \SrobustB,
%but we are also able to write other useful properties about the bank account. 

 
Consider now another four \Nec specifications:
 
\begin{lstlisting}[language = Chainmail, mathescape=true, frame=lines]
$\text{\SRobustNextAcc}$  $\triangleq$  from a:Account $\wedge$ a.balance==bal  next a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\access{\prg{o}}{\prg{a.pwd}}$]                                           

$\text{\SRobustNextCall}$  $\triangleq$  from a:Account $\wedge$ a.balance==bal  next a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]
                       
$\text{\SRobustToCall}$  $\triangleq$  from a:Account $\wedge$ a.balance==bal to a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]  
                                          
$\text{\SRobustToAcc}$  $\triangleq$  from a:Account $\wedge$ a.balance==bal to a.balance < bal
                       onlyThrough $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]

\end{lstlisting}


\sd{The specification \SRobustNextAcc  states that
the balance of an account decreases \emph{in one step}, only if an external object has access to the 
password. It is similar to \SrobustB, with the difference that the
decrease   takes place in \emph{one} step, rather than in \emph{a number} of steps.}
%
%Interestingly, e
Even though \ModB does not satisfy \SrobustB, it does satisfy\SRobustNextAcc:
\\
\strut $\hspace{.6in}$ \ModB$\vDash$ \SRobustNextAcc
$\hspace{.6in}$ \ModC$\vDash$ \SRobustNextAcc

The specifications \SRobustNextCall and   \SRobustToCall are similar:
they both say that a decrease of the balance can only happen if the current statement is a call to \prg{transfer}.  The former considers   a \emph{single} step, while the latter allows for \emph{any number} of steps. 
 \SrobustB is slightly different, because it  says that such a decrease is only possible if some \emph{intermediate}
 step called \prg{transfer}.
 All three 
 modules satisfy 
\SRobustNextCall and \SRobustNextAcc,  and none satisfy \SRobustToCall. That is:
%\\
%\strut $\hspace{1in}$ \ModA$\vDash$ \SrobustB$_b$
 \\
\strut $\hspace{.6in}$ \ModB$\vDash$  \SRobustNextCall 
$\hspace{.6in}$ \ModC$\vDash$  \SRobustNextCall 
 \\
\strut $\hspace{.6in}$ \ModB$\vDash$ \SRobustToCall
$\hspace{.6in}$ \ModC$\vDash$\SRobustToCall
%\strut $\hspace{1in}$ \ModB$\nvDash$ \SrobustB$_c$
 \\
\strut $\hspace{.6in}$ \ModB$\nvDash$ \SRobustToCall
 $\hspace{.6in}$ \ModC$\nvDash$ \SRobustToCall


\label{ss:DOM}

\subsubsection{The DOM}  %\sophiaPonder[renamed Wrapper to Proxy]{  
This is the motivating example in \cite{dd},
dealing with a tree of DOM nodes: Access to a DOM node
gives access to all its \prg{parent} and \prg{children} nodes, with the ability to
modify the node's \prg{property} -- where  \prg{parent}, \prg{children} and \prg{property}
are fields in class \prg{Node}. Since the top nodes of the tree
usually contain privileged information, while the lower nodes contain
less crucial third-party information, we must be able to limit 
 access given to third parties to only the lower part of the DOM tree. We do this through a \prg{Proxy} class, which has a field \prg{node} pointing to a \prg{Node}, and a field \prg{height}, which restricts the range of \prg{Node}s which may be modified through the use of the particular \prg{Proxy}. Namely, when you hold a \prg{Proxy}  you can modify the \prg{property} of all the descendants of the    \prg{height}-th ancestors of the \prg{node} of that particular \prg{Proxy}.  We say that
\prg{pr} has \emph{modification-capabilities} on \prg{nd}, where \prg{pr} is
a  \prg{Proxy} and \prg{nd} is a \prg{Node}, if the \prg{pr.height}-th  \prg{parent}
of the node at \prg{pr.node} is an ancestor of \prg{nd}.
%}


The specification \prg{DOMSpec} states that the \prg{property} of a node can only change if
some external object presently has 
access to a node of the DOM tree, or to some \prg{Proxy} with modification-capabilties
to the node that was modified.
\begin{lstlisting}[language = Chainmail, mathescape=true, frame=lines]
DOMSpec $\triangleq$ from nd : Node $\wedge$ nd.property = p  to nd.property != p
          onlyIf $\exists$ o.[ $\external {\prg{o}}$ $\wedge$ 
                       $( \  \exists$ nd':Node.[ $\access{\prg{o}}{\prg{nd'}}$ ]  $\vee$ 
                         $\exists$ pr:Proxy,k:$\mathbb{N}$.[$\, \access{\prg{o}}{\prg{pr}}$ $\wedge$ nd.parent$^{\prg{k}}$=pr.node.parent$^{\prg{pr.height}}$ ] $\,$ ) $\,$ ]
\end{lstlisting}

\subsubsection{Expressiveness}
As stated earlier, \Nec is less expressive than
\emph{Chainmail}.
%or {\sc{VerX}}. 
Nevertheless, we believe that
it  is powerful enough for the purpose of straightforwardly
expressing robustness requirements. 
In order to investigate \Nec's expressiveness,  
we used it for
examples provided in the literature. In this section we considered the DOM example, 
proposed by  \citeauthor{dd}. In Appendix \ref{s:expressiveness:appendix},
we compare with examples proposed by  \citeauthor{FASE}.
 

