\subsection{More Examples,   Expressiveness of \Nec}
% do not say \Nec Specifications
% because it is language that is expressive, not the specification
\label{s:expressiveness}

We now consider some more specifications, and discuss whether given modules satisfy them.

 \subsubsection{More examples of the Bank}\sophiaPonder[quite different from earlier; check please]{}
Looking back at the example from the Sect. \ref{s:outline},   it holds that
\\
\strut % $\hspace{.6in}$ \prg{Mod1} $\vDash$ \prg{NecessityBankSpec}
 % \\ \strut 
 $\hspace{.6in}$ \prg{Mod2} $\nvDash$ \prg{NecessityBankSpec}
  $\hspace{.6in}$ \prg{Mod3} $\vDash$ \prg{NecessityBankSpec}
 

 
% SD dropped the below -- not that useful
% For more specification examples, consider the
%bank account discussed in Section \ref{s:intro}. We have already shown
%how we can specify knowledge of an account's password using \prg{NecessityBankSpec},
%but we are also able to write other useful properties about the bank account. 

 
Consider now another four \Nec specifications:
 
\begin{lstlisting}[language = Chainmail, mathescape=true, frame=lines]
NecessityBankSpec$_a$  $\triangleq$  from a:Account $\wedge$ a.balance==bal  nxt a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\access{\prg{o}}{\prg{a.pwd}}$]                                           

NecessityBankSpec$_b$  $\triangleq$  from a:Account $\wedge$ a.balance==bal  nxt a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]
                       
NecessityBankSpec$_c$  $\triangleq$  from a:Account $\wedge$ a.balance==bal to a.balance < bal
                       onlyIf $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]
                       
NecessityBankSpec$_d$  $\triangleq$  from a:Account $\wedge$ a.balance==bal to a.balance < bal
                       onlyTrough $\exists$ o.[$\external{\texttt{o}}$ $\wedge$ $\calls{\prg{o}}{\prg{a}}{\prg{transfer}}{\prg{\_, \_, \_}}$]
\end{lstlisting}


The specification \prg{NecessityBankSpec}$_a$ states that
the balance of an account decreases \emph{in one step}, only if an external object has access to the 
password. It is similar to \prg{NecessityBankSpec}, with the difference that the
decrease   takes place in \emph{one} step, rather than in \emph{a number} of steps.
%
Interestingly, even though \prg{Mod2} does not satisfy \prg{NecessityBankSpec}, it does satisfy \prg{NecessityBankSpec}$_a$.
\\
\strut $\hspace{.6in}$ \prg{Mod2} $\vDash$ \prg{NecessityBankSpec}$_a$
$\hspace{.6in}$ \prg{Mod3} $\vDash$ \prg{NecessityBankSpec}$_a$

The specifications \prg{NecessityBankSpec}$_b$ and  \prg{NecessityBankSpec}$_c$ are similar:
they both say that a decrease of the balance can only happen if the current statement is a call to \prg{transfer}. They differ in that the former considers   a \emph{single} step, while the latter allows for \emph{any number} of steps. 
 \prg{NecessityBankSpec}$_d$ says that such a decrease is only possible if some \emph{intermediate}
 step called \prg{transfer}.
 All three 
 modules satisfy 
\prg{NecessityBankSpec}$_b$ and \prg{NecessityBankSpec}$_d$,  and none satisfy \prg{NecessityBankSpec}$_c$. That is:
%\\
%\strut $\hspace{1in}$ \prg{Mod1} $\vDash$ \prg{NecessityBankSpec}$_b$
 \\
\strut $\hspace{.6in}$ \prg{Mod2} $\vDash$ \prg{NecessityBankSpec}$_b$
$\hspace{.6in}$ \prg{Mod3} $\vDash$ \prg{NecessityBankSpec}$_b$
 \\
\strut $\hspace{.6in}$ \prg{Mod2} $\vDash$ \prg{NecessityBankSpec}$_d$
$\hspace{.6in}$ \prg{Mod3} $\vDash$ \prg{NecessityBankSpec}$_d$
%\strut $\hspace{1in}$ \prg{Mod1} $\nvDash$ \prg{NecessityBankSpec}$_c$
 \\
\strut $\hspace{.6in}$ \prg{Mod2} $\nvDash$ \prg{NecessityBankSpec}$_c$
 $\hspace{.6in}$ \prg{Mod3} $\nvDash$ \prg{NecessityBankSpec}$_c$


\label{ss:DOM}

\subsubsection{The DOM}  \sophiaPonder[renamed Wrapper to Proxy]{  
The DOM example is the motivating example in \cite{dd}. 
It deals with a tree of DOM nodes: Access to a DOM node
gives access to all its \prg{parent} and \prg{children} nodes, and the ability to
modify the node's \prg{property} -- where  \prg{parent}, \prg{children} and \prg{property}
are fields in class \prg{Node}. However, as the top nodes of the tree
usually contain privileged information, while the lower nodes contain
less crucial third-party information, we want to be able to limit 
 access given to third parties to only the lower part of the DOM tree. We do this through a \prg{Proxy} class, which has a field \prg{node} pointing to a \prg{Node}, and a field \prg{height} is a number which restricts the range of \prg{Node}s which may be modified through the use of the particular \prg{Proxy}. Namely, when you hold a \prg{Proxy}  you can modify the \prg{property} of all the descendants of the    \prg{height}-th ancestors of the \prg{node} of that particular \prg{Proxy}.  We say that
\prg{pr} has \emph{modification-capabilities} on \prg{nd}, where \prg{pr} is
a  \prg{Proxy} and \prg{nd} is a \prg{Node}, if the \prg{pr.height}-th  \prg{parent}
of the node at \prg{pr.node} is an ancestor of \prg{nd}.
}


The specification \prg{DOMSpec} states that the \prg{property} of a node \jm[]{can only change if}
some external object presently has 
access to a node of the DOM tree, or to some \prg{Proxy} with modification-caapbilties
to the node that was modified.
\begin{lstlisting}[language = Chainmail, mathescape=true, frame=lines]
DOMSpec $\triangleq$ from nd : Node $\wedge$ nd.property = p  to nd.property != p
          onlyIf $\exists$ o.[ $\external {\prg{o}}$ $\wedge$ 
                       $( \  \exists$ nd':Node.[ $\access{\prg{o}}{\prg{nd'}}$ ]  $\vee$ 
                         $\exists$ pr:Proxy,k:$\mathbb{N}$.[$\, \access{\prg{o}}{\prg{pr}}$ $\wedge$ nd.parent$^{\prg{k}}$=pr.node.parent$^{\prg{pr.height}}$ ] $\,$ ) $\,$ ]
\end{lstlisting}

\subsubsection{Expressiveness}
\sophiaPonder[new]{As stated earlier, \Nec is less expressive than
\emph{Chainmail} or {\sc{VerX}}. Nevertheless, we believe that
it  is expressive enough for the purpose of 
expressing robustness requirements. 
In order to investigate the expressiveness of \Nec 
we compared with
examples provided in the literature. In this section we considered the DOM example, 
proposed by  \citeauthor{dd}. In the appendix, in Sec. \ref{s:expressiveness:appendix},
we compare with examples proposed by  \citeauthor{FASE}.}
 

