\begin{figure}[h!]  
\fbox{
$
\begin{array}{c}
 \prg{e}:\prg{ERC20}\ \wedge\  \prg{p},\prg{p''}:\prg{Object} 
  \wedge\ \prg{m},\prg{m}',\prg{m}'':\prg{Nat}\ \wedge\   \\
 \prg{e}.\prg{balance(p)} = \prg{m}+\prg{m}'\ \ \wedge\ \ \prg{e}.\prg{balance(p'')} = \prg{m}''\ \ \wedge\ \ \prg{this}=\prg{p} \\
   \{ \ \ \prg{e.transfer(p'',m')} \ \ \}   \\
    \prg{e}.\prg{balance(p)} = \prg{m}\ \ \wedge\ \ \prg{e}.\prg{balance(p'')} = \prg{m}''+\prg{m}'
\ \ \\
\ \ \\
  \prg{e}:\prg{ERC20}\ \wedge\  \prg{p},\prg{p'}:\prg{Object}  \wedge\ \prg{m},\prg{m}',\prg{m}'':\prg{Nat}\ \wedge\     \prg{e}.\prg{balance(p)} = \prg{m} \ \ \wedge \prg{m} <  \prg{m}'  \\
   \{ \ \ \prg{e.transfer(p',m')} \ \ \}   \\
  \prg{e}.\prg{balance(p)} = \prg{m}  
  \\
  \\
\prg{e}:\prg{ERC20}\ \wedge\  \prg{p},\prg{p'},\prg{p}'':\prg{Object} 
  \wedge\ \prg{m},\prg{m}',\prg{m}'',\prg{m}''':\prg{Nat}\ \wedge\   \\
 \prg{e}.\prg{balance(p)} = \prg{m}+\prg{m}'\ \ \wedge\ \ \prg{e}.\prg{allowed(p,p')}=\prg{m}'''+\prg{m}' \ \wedge\\
  \prg{e}.\prg{balance(p'')} = \prg{m}''\ \ \wedge\ \ \prg{this}=\prg{p'} \\
   \{ \ \ \prg{e.transferFrom(p',p'',m')} \ \ \}   \\
    \prg{e}.\prg{balance(p)} = \prg{m}\ \ \wedge\ \ \prg{e}.\prg{balance(p'')} = \prg{m}''+\prg{m}'
     \ \wedge\ \ \prg{e}.\prg{allowed(p,p')}=\prg{m}'''
\ \ \\
\ \ \\
  \prg{e}:\prg{ERC20}\ \wedge\  \prg{p},\prg{p'}:\prg{Object}  \wedge\ \prg{m},\prg{m}',\prg{m}'':\prg{Nat}\ \wedge\ \prg{this}=\prg{p}' \ \wedge \\
      ( \ \prg{e}.\prg{balance(p)} =\prg{m} \wedge \prg{m} <  \prg{m}''\  \vee \ 
  \prg{e}.\prg{allowed(p,p')}=\prg{m'} \wedge \prg{m'} < \prg{m}'' \ ) \\
   \{ \ \ \prg{e.transferFrom(p,p'',m'')} \ \ \}   \\
  \prg{e}.\prg{balance(p)} = \prg{m} \wedge  \prg{e}.\prg{allowed(p,p')}=\prg{m'}
  \\
  \\
  \prg{e}:\prg{ERC20}\ \wedge\  \prg{p},\prg{p'}:\prg{Object}  \wedge\ \prg{m}:\prg{Nat}\ \wedge\ \prg{this}=\prg{p}  \\
   \{ \ \ \prg{e.approve(p',m')} \ \ \}   \\
  \prg{e}.\prg{allowed(p,p')} = \prg{m} 
  \\
  \\
   \prg{e}:\prg{ERC20}\ \wedge\ \prg{m}:\prg{Nat}\ \wedge\    \prg{p}.\prg{balance}=\prg{m}    \\
   \{ \ \ \prg{k}=\prg{e.balanceOf(p)} \ \ \}   \\
  \prg{k}=\prg{m} \ \wedge \ \prg{e.balanceOf(p)} = \prg{m}  
  \\
  \\
   \prg{e}:\prg{ERC20}\ \wedge\ \prg{m}:\prg{Nat}\ \wedge\    \prg{e}.\prg{allowed(p,p')}=\prg{m}    \\
   \{ \ \ \prg{k}=\prg{e.allowance(p,p')} \ \ \}   \\
  \prg{k}=\prg{m} \ \wedge \ \prg{e}.\prg{allowed(p,p')}=\prg{m} 
  \\
  \\
   \prg{e}:\prg{ERC20}\ \wedge\ \prg{m}:\prg{Nat}\ \wedge\     \sum_{\prg{p}\in dom(\prg{e}.\prg{balance})}^{}{\prg{e}.\prg{balance}(\prg{p})}=\prg{m}    \\
   \{ \ \ \prg{k}=\prg{e.totalSupply()} \ \ \}   \\
  \prg{k}=\prg{m}   
\end{array}
$
}
\caption{Classical specification for the \prg{ERC20}}
\label{fig:classicalERC20}
\end{figure}