%% For double-blind review submission, w/o CCS and ACM Reference (max submission space)
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review,anonymous,screen]{acmart}\settopmatter{printfolios=true,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
%proposed
\documentclass[acmsmall]{acmart}
%We had
%\documentclass[acmsmall,screen]{acmart}\settopmatter{printfolios=true,printacmref=false}


% THESE ARE ADVISED BY DEFAULT
\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc} 
\usepackage{microtype}

% THESE WERE ARE NEEDED
\usepackage[shortlabels]{enumitem}
 \usepackage{wrapfig}
 
%NOT NEEDED
%\usepackage{mathtools}


\DeclareSymbolFont{arrows}{U}{FdSymbolC}{m}{n}

% \usepackage{ amssymb }
% \DeclareTextFontCommand{\texttt}{\ttfamily}

%% Journal information
%% Supplied to authors by publisher for camera-ready submission;
%% use defaults for review submission.
\acmJournal{PACMPL}
\acmVolume{}
\acmNumber{OOPSLA} % CONF = POPL or ICFP or OOPSLA
\acmArticle{}
\acmYear{2025}
\acmMonth{1}
\acmDOI{} % \acmDOI{10.1145/nnnnnnn.nnnnnnn}
\startPage{1}

%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission;
%% use 'none' for review submission.
\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\copyrightyear{2018}           %% If different from \acmYear

%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
%% Note: author/year citations are required for papers published as an
%% issue of PACMPL.
%\citestyle{acmauthoryear}   %% For author/year citations
\citestyle{acmnumeric}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Note: Authors migrating a paper from PACMPL format to traditional
%% SIGPLAN proceedings format must update the '\documentclass' and
%% topmatter commands above; see 'acmart-sigplanproc-template.tex'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Some recommended packages.
\usepackage{booktabs}   %% For formal tables:
                        %% http://ctan.org/pkg/booktabs
\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
                        %% http://ctan.org/pkg/subcaption
 \usepackage{ stmaryrd }                       

\usepackage{relsize}
\usepackage{mathpartir}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{listings}
\usepackage{xspace}
\usepackage{definitions}
\usepackage{multirow,bigdelim}
\usepackage{pbox}
\usepackage{courier}
\usepackage{soul}
\usepackage{centernot}
 

\newcommand\multibrace[3]{\rdelim\}{#1}{3mm}[\pbox{#2}{#3}]}
\newcommand{\aref}[2]{#2}

%%these COLOUR MACROS ARE ACTIVELY FUCKING EVIL
%%DO NOT DO THIS. EVER
%%AT LEast have some ovious way to TURN THEM OFF

\definecolor{ferngreen}{rgb}{0.31, 0.47, 0.26}
\newcommand{\kjx}[1]{{}}
\newcommand{\scd}[1]{{}}
\newcommand{\sdnew}[1]{{\color{blue}{#1}}}
\newcommand{\sdnewer}[1]{{\color{amber}{#1}}}
%\newcommand{\jm}[1]{{\color{magenta}{JM: #1}}}
\newcommand{\sdcomment}[1]{{}}
\newcommand{\secomment}[1]{{}}
\newcommand{\jncomment}[1]{{}}

\newcommand{\sd}[1]{{{#1}}}
\newcommand{\se}[1] {#1} %{{\color{brown}{#1}}}
\newcommand{\sue}[1] {{\color{brown}{#1}}}
\definecolor{amber}{rgb}{1.0, 0.75, 0.0}
\definecolor{amethyst}{rgb}{0.6, 0.4, 0.8}

\newcommand{\ponders}[3]{\marginpar{\tiny\itshape\raggedright\textcolor{#2}{\textbf{#1:} #3}}\ignorespaces}
\renewcommand{\ponders}[3]{{#3\ignorespaces}}  %TURNING IT OFF. NOT THAT IT FUCKING HEPLS

\marginparwidth=1.6cm \marginparsep=0cm
\newcommand{\TODO}[1]{} % {{\color{red}#1}}
\newcommand{\sophia}[1]{{#1}}
\newcommand{\toby}[1]{} % {\ponders{Toby}{purple}{#1}}
\newcommand{\susan}[2][]{{#2}\xspace}
\newcommand{\james}[1]{\ponders{James}{orange}{#1}}
\newcommand{\jm}[2][]{\ponders{Julian}{magenta}{#1} {#2}\xspace}
\newcommand{\sdNr}[2][]{\ponders{SD:}{amber}{#1} {#2}\xspace}
\newcommand{\sdN}[1]{{{#1}}}
\newcommand{\sdNO}[1]{\red{ {#1}}} %{\ponders{SD:}{amber}{ } {#1}\xspace}
\newcommand{\julian}[1]{{#1}\xspace}
\newcommand{\sdM}[1]{#1\xspace}

\newcommand{\sophiaPonder}[2][]{\ponders{Sophia}{blue}{#1}{#2}\xspace}
\renewcommand{\sophia}[2][]{}

\newcommand{\sdfootnote}[1]{}



\begin{document}

%% Title information
%\title[Specification and Proof of Necessary Conditions]{Specification
%and Proof of Necessary Conditions}         %% [Short Title] is
%optional;
%\title{Necessity Specifications are Necessary
%\title{Reasoning about External Calls with Limited Effects}
\title{Reasoning about External Calls}
%\title{Limiting the Effects of External Calls}
%\title{Limited Effects for Reasoning about External Calls}
%\title{Reasoning about External Calls}

% \title{\Nec Specifications are Necessary for Robustness}

                                        %% when present, will be used in
                                        %% header instead of Full Title.
%\titlenote{with title note}             %% \titlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'
%\subtitle{Subtitle}                     %% \subtitle is optional
%\subtitlenote{with subtitle note}       %% \subtitlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'


%% Author information
%% Contents and number of authors suppressed with 'anonymous'.
%% Each author should be introduced by \author, followed by
%% \authornote (optional), \orcid (optional), \affiliation, and
%% \email.
%% An author may have multiple affiliations and/or emails; repeat the
%% appropriate command.
%% Many elements are not rendered, but should be provided for metadata
%% extraction tools.
 
%% Author with single affiliation.
\author{Sophia Drossopoulou}
%\authornote{with author1 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{0000-0002-1993-1142}             %% \orcid is optional
\affiliation{
  %\position{Position1}
  %\department{Department1}              %% \department is recommended
  \institution{Imperial College London}            %% \institution is required
  %\streetaddress{Street1 Address1}
  %\city{City1}
  %\state{State1}
  %\postcode{Post-Code1}
  \country{UK} %  \country{United Kingdom}                    %% \country is recommended
}
\email{scd@imperial.ac.uk}          %% \email is recommended


%% Author with two affiliations and emails.
\author{Julian Mackay}
%\authornote{with author2 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{0000-0003-3098-3901}             %% \orcid is optional
\affiliation{
  %\position{Position2a}
  %\department{Engineering and Computer Science}             %% \department is recommended
  \institution{Victoria University of Wellington}           %% \institution is required
  %\streetaddress{Street2a Address2a}
  %\city{City2a}
  %\state{State2a}
  %\postcode{Post-Code2a}
   \country{NZ}   % \country{New Zealand}                   %% \country is recommended
}
\email{julian.mackay@ecs.vuw.ac.nz}         %% \email is recommended


\author{Susan Eisenbach}
%\authornote{with author2 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{0000-0001-9072-6689}             %% \orcid is optional
\affiliation{
  %\position{Position2a}
  %\department{}             %% \department is recommended
  \institution{Imperial College London}           %% \institution is required
  %\streetaddress{Street2a Address2a}
  %\city{City2a}
  %\state{State2a}
  %\postcode{Post-Code2a}
  \country{UK} %   \country{United Kingdom}                   %% \country is recommended
}
\email{susan@imperial.ac.uk}         %% \email is recommended

\author{James Noble}
%\authornote{with author2 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{0000-0001-9036-5692}             %% \orcid is optional
\affiliation{
  %\position{Position2a}
  %\department{Department2a}             %% \department is recommended
  \institution{Creative Research \& Programming}           %% \institution is required
 % \streetaddress{5 Fernlea Ave, Darkest Karori}
  \city{Wellington}
  %\state{State2a}
  \postcode{6012}
   \country{NZ}   %  \country{New Zealand}                   %% \country is recommended
}
\email{kjx@acm.org}         %% \email is recommended




%% Abstract
%% Note: \begin{abstract}...\end{abstract} environment must come
%% before \maketitle command


  

%% 2012 ACM Computing Classification System (CSS) concepts
%% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
\begin{CCSXML}
<ccs2012>
   <concept>
       <concept_id>10011007.10010940.10010992.10010993.10011683</concept_id>
       <concept_desc>Software and its engineering~Access protection</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011074.10011099.10011692</concept_id>
       <concept_desc>Software and its engineering~Formal software verification</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10003752.10003790.10011741</concept_id>
       <concept_desc>Theory of computation~Hoare logic</concept_desc>
       <concept_significance>500</concept_significance>
       </concept>
   <concept>
       <concept_id>10011007.10011006.10011008.10011009.10011011</concept_id>
       <concept_desc>Software and its engineering~Object oriented languages</concept_desc>
       <concept_significance>300</concept_significance>
       </concept>
 </ccs2012>
\end{CCSXML}

\ccsdesc[300]{Software and its engineering~Access protection}
\ccsdesc[500]{Software and its engineering~Formal software verification}
\ccsdesc[500]{Theory of computation~Hoare logic}
\ccsdesc[300]{Object oriented programming~Object capabilities}


\newcommand{\paragraphsd}[1]{\vspace{.02cm}{\textit{#1}}}

%% End of generated code

  
%% End of generated code


%% Keywords
%% comma separated list
%%%%%%%%%%%%%%%%%%%%%\keywords{keyword1, keyword2, keyword3}  %% \keywords are mandatory in final camera-ready submission



%% Note: \maketitle command must come after title commands, author
%% commands, abstract environment, Computing Classification System
%% environment and commands, and keywords command.


  \input{abstract} % must come before maetitle

\maketitle 


 \input{introduction}
 
\section{The problem and our approach}
\label{s:outline}  
\input{approach}
%%
%%%  \input{bitsandbobs}
%%
%%

\input{underlying}
 \label{s:underlying}
   
\section{Assertions} %\AssertLang -- the assertion language}
\label{s:assertions}
\input{assertions}


 \subsection{Preservation of Assertions}
 \label{s:preserve}
 \input{PreserveSatisfaction}

\section{ Specifications}
\label{sect:spec}    
\input{specifications}

%%% \input{expressive}

\section{Hoare Logic} %Proving Open Calls and Adherence to \SpecLang Specifications}
\label{sect:proofSystem}
 \input{inference}
 
 
 \section{Soundness} % of our proof system}
 \label{sect:sound:proofSystem}
\input{soundness}

%  \section{Our Example Proven} % of our proof system}
% \label{sect:example:proof:short}
%\input{exampleProofsShort}

  \section{Conclusion: Summary, Related Work and Further Work}
 \label{sect:related}
\label{sect:conclusion}
 \input{related}

%\sdnew
{\section*{Acknowledgements}
We are grateful for the feedback from Lars Birkedal, David Swasey, Peter Müller, Derek Dreyer, Dominique Devriese, and the anonymous OOPSLA reviewers. 
We are especially thankful to Reviewer B, and even more so to Reviewer C, whose % detailed feedback and
 sustained engagement across multiple rounds of discussion went well beyond %the usual 
 expectations and was instrumental in helping us clarify parts of the work that were initially unclear.
}

 %  \Input{furtherQuestions}
%%  \input{examples}

%\section{Discussion}
%
% \input{related}
%
% \input{conclusion}

%\clearpage
%\section*{Data Availability Statement}
%
%An extended version of the paper including extensive appendices of
%full definitions and manual proofs have been uploaded as anonymised
%auxiliary information with this submission.
%
%The Coq source will be submitted as an artefact to
%the artefact evaluation process. The code artefact, along with
%the extended appendices etc will be made permanently available in the
%ACM Digital Library archive.



%% Bibliography
\bibliography{Case,more,Response1}   %%,more,Response1}
\clearpage

%\section{If we have space, somewhere}
%
% \subsection{Discussion of the semantics of assertions}
% 
% {Both existential and universal quantification (defined in \ref{quant1} and \ref{quant2}) is done over all objects which are transitively 
%accessible any frame in the stack (as in OOPSLA). But note that $\satisfiesA{M}{\sigma} {\inside {y}}$ only considers objects that are locally reachable ..
%
%We do not include quantification over primitive types such as integers as \LangOO is too simple. The 
%Coq mechanisation does include primitive types.}
%\footnoteSD{TODO: Do we prove the implications as in TACAS, or just rely on TACAS? -- perhaps the former, since we have some new primitives? hmhh}
%
%\subsubsection{Alternative Definition of Protection}
%
%We could have given a weaker definition of protection, which would require that $o$ is protected from $o'$ if $o'$ can obtain direct access to $o$ only if some internal object executes a method. 
%The projection of this weaker definition into the heap structure is as below
%
%
%$\satisfiesA{M}{\sigma}{ {\alpha\ }\textbf{weakPrtFrom}\ {\alpha_o} }$  \ \ \ iff \\
%\begin{itemize}
%\item $\satisfiesA{M}{\sigma}{\internal{\alpha_0}}$, \\ or
%\item 
%$\forall n\in\mathbb{N}. \forall f_1,...f_n.$\\
%$
%[\ \ \interpret{\sigma}{\alpha_{o}.f_1...f_n}=\alpha \ \ \  \Longrightarrow \ \ \ \exists k<n. \satisfiesA{M} {\sigma} {\internal{{\interpret{\sigma}{\alpha_{o}.f_1...f_{k}}}}}\ \ ]$
%\end{itemize}
%
%
%With this, weaker, definition, in Fig. \ref{fig:ProtectedFrom}, object $6$ would be weakly-protected from $2$. Namely,  here 
%for $2$  to get access to $6$ it suffices for $3$ to introduce $5$ to $2$, and does not require that some internal object introduces $6$ to some external object\footnoteSD{TODO? Hmhh This would have been clearer if there was also a field pointing from 3 to 5}.
%!TEX encoding = UTF-8 Unicode
%Note however that this alternative definition does not satisfy Lemma \ref{lemma:rel:abs:prot}. For a counterexample,   consider pushing onto the frame $\phi_1$ from Fig. \ref{fig:ProtectedFrom}, a frame $\phi_4$ where $\phi_4(\prg{this})$=$2$. Then, Lemma
%\ref{lemma:rel:abs:prot} would promise that $6$ is protected from that frame, even though it is not.

\appendix
% \input{appendix}
%% Appendix
%\appendix
%\appendix
\input{appendix/loo}
\input{appendix/appendixBankWithGhost}
\clearpage
\input{appendix/appendixAuxiliary}
% No appendix needed
% Section has no lemmas
 \clearpage
\input{appendix/appendixAssertions}
\clearpage

\input{appendix/appendixPreserve}
\clearpage

\input{appendix/appendixSpecifications}
\clearpage

\input{appendix/appendixHoare}
\clearpage

\input{appendix/appendixSound}
\clearpage

\input{appendix/appendixExample}

\end{document}
