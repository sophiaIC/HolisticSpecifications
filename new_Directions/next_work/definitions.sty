\ProvidesPackage{definitions}[2021/05/18 v1.0 chainmailDefs]

\usepackage{xspace}
\usepackage{tcolorbox}
\usepackage{calrsfs}
\usepackage{tikz}
\usepackage{listings}
\usepackage{cancel}
\usepackage{graphicx}
\usetikzlibrary{arrows, positioning, decorations.pathmorphing}
\DeclareMathAlphabet{\pazocal}{OMS}{zplm}{m}{n}



% --------------------------------------------------------------  colours --------------------------------------------------------------  
\definecolor{hotpink}{rgb}{1.0, 0.41, 0.71}
%\definecolor{darkgreen}{rgb}{0.08, 0.39, 0.25}
\definecolor{darkgreenA}{rgb}{0.01, 0.49, 0.31}
\definecolor{darkgreen}{rgb}{0.08, 0.39, 0.25}
\definecolor{lightseagreen}{rgb}{0.13, 0.7, 0.67}
 \newcommand{\sdOct}[1]{#1}
\newcommand{\red}[1]{
	\color{red}#1 \color{black}
}
\newcommand{\blue}[1]{
	\color{blue}#1 \color{black}
}
\newcommand{\green}[1]{
	\color{darkgreen}#1 \color{black}
}
\newcommand{\sdNew}[1]{\color{red}#1 \color{black}}
 \newcommand{\sdr}[2][]{\ponders{SD:}{blue}{#1} {#2}\xspace}
\newcommand{\sdred}[1]{\red{#1}}

\newcommand{\footnoteSD}[1]{} % ignore for the time being
\newcommand{\sdtodo}[1]{\footnoteSD{#1}}
\newcommand{\npgreen}[1]{\color{darkgreenA}#1 \color{black}}  % new prroof in green

%--------------------------------------------------------------  layout, and general English --------------------------------------------------------------


\newcommand{\ie}{\emph{i.e.}\xspace}  
\newcommand{\eg}{\emph{e.g.}\xspace}
\newcommand{\etc}{\emph{etc.}\xspace}
\newcommand{\Eg}{\emph{E.g.,}\xspace}    
\newcommand{\cf}{\emph{c.f.}\xspace} 
\newcommand{\Cf}{\emph{C.f.}\xspace} 
\newcommand{\A}{Appendix}
\newcommand{\notesep}{$\bullet$\ }

\newcommand{\citeauthorwithyear}[1]{\citeauthor{#1} \citeyear{#1}}
\newcommand{\citeasnoun}[1]{\citeauthor{#1} [\citeyear{#1}]}

\newcommand{\forget}[1]{ }
\newcommand{\move}[1]{ }
\newcommand\IntSet{\mathbb{Z}}
\newcommand{\lclSPACE}{\ \ \ \ \ }
\newcommand{\SPSP}{\ \ \ \ \ \  \ \ \ \  }

%-------------- names of specs ---
\newcommand{\SThree}{S_3}
\newcommand{\SThreeStrong}{S_{3,strong}}

% -------------------------------------------------------------- Terminology --------------------------------------------------------------
\newcommand{\internalO}{internal\xspace}  % for internal object 
\newcommand{\internalC}{internal\xspace}  % for internal call 
\newcommand{\internalM}{internal\xspace}   % for internal module
\newcommand{\externalM}{external\xspace}    % for external module
\newcommand{\externalC}{external\xspace} % for external call
\newcommand{\externalO}{external\xspace}% for external object
\newcommand{\enclosed}{\texttt{confined}\xspace}  % for external object

\newcommand{\atom}{atom\xspace}
\newcommand{\scoped}{scoped\xspace}
\newcommand{\Strong}{Strong\xspace}
\newcommand{\strong}{strong\xspace}
%\newcommand{\atoms}{atoms\xspace}  
\newcommand{\midcond}{midcondition\xspace}

\newcommand{\balance}{\prg{blnce}}
\newcommand{\password}{\prg{key}}
\newcommand{\myAccount}{\prg{accnt}}


\newcommand{\Tamed}{Tamed\xspace}
\newcommand{\tamed}{tamed\xspace}
\newcommand{\tame}{tame\xspace}
\newcommand{\tames}{tames\xspace}
\newcommand{\Taming}{Taming\xspace}
\newcommand{\taming}{taming\xspace}

% --------------------------------------------------Theorem, Lemma etc --------------------------------------------------------------
\newtheorem{theorem}{Theorem}[section]
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{definitionLemma}[theorem]{Definition and Lemma}
\usepackage{soul}
\newtheorem{axiom}[theorem]{Axiom}
%\numberwithin{axiom}{section}
\newtheorem{auxLemma}[theorem]{Auxiliary Lemma}
\newtheorem{auxDefinition}[theorem]{Auxiliary Definition}
% \numberwithin{auxLemma}{section}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{note}[theorem]{Note}
% this does not work :-(
% \renewtheorem{theorem}[theorem]{Theorem}

 \newtheorem{Theorem}[theorem]{Theorem}

\newtheorem{example}[theorem]{Example}
 
 \newcommand{\beginProof}[1]{\noindent {\textbf{Proof of lemma \ref{#1}}}}
 \newcommand{\completeProof}{\noindent {\textbf{End Proof}}}
 \newcommand{\beginProofSub}[2]{\noindent {\textbf{Proof of lemma \ref{#1}, part  \ref{#2} } } }
 \newcommand{\completeProofSub}{\noindent {\textbf{End Proof}}}
 
 \newenvironment{proofO}{{\sc{Proof Outline}}}{  \hfill $\square$}
 
%---------------------------------------------------- Symbols ------------------------------------------------------------------
\newcommand{\re}{\mathit{e}}
\newcommand{\madd}{\!\cdot\!}



\newcommand{\prg}[1]{\mbox{\normalfont{\texttt{#1}}}}

\newcommand\txteq{\mathrel{\stackrel{\makebox[0pt]{\mbox{\normalfont\tiny txt}}}{=}}}
\newcommand\txtin{\mathrel{\stackrel{\makebox[0pt]{\mbox{\normalfont\tiny txt}}}{\leq}}}
\newcommand\txtneq{\mathrel{\stackrel{\makebox[0pt]{\mbox{\normalfont\tiny txt}}}{\neq}}}


% -------------------------------------------------- Specifications --------------------------------------------------------------
% \newcommand{\myforall}{\kern.05em\ensuremath\forall\kern-.63em\rotatebox{110}{\rule{.73em}{.4pt}}\ }
%\newcommand{\myforall}{\ensuremath{ \forall \!\ \! \! \!  \forall}}
%\newcommand{\myforall}{\ensuremath{ \forall \! {\scriptsize{/}}}}
\newcommand{\myforall}%{\rotatebox{180}{\mathbb{A}}}
{\ \rotatebox[origin=c]{180}{{\ensuremath{\mathbb{A}\!\!}}}}
%{\raisebox{\depth}{\rotatebox{180}{#1}}\hspace{-1em}\rule{1em}{0.5pt}}
 

\newcommand{\TwoStatesN}[2]{\ensuremath{\myforall {#1}.{\oopenBr}{#2}{\ccloseBr}}}
\newcommand{\TwoStatesLB}[3]{\ensuremath{\myforall {#1}.}\\
             {\ensuremath{\strut\hspace{4cm}{\oopenBr}{#2}{\ccloseBr}. \oopenBr}{#3}{\ccloseBr}}}
\newcommand{\TwoStates}[3]{\ensuremath{\myforall {#1}.{\oopenBr}{#2}{\ccloseBr}. \oopenBr}{#3}{\ccloseBr}}

\newcommand{\oopenBr}{{\openBr}\!\! {\openBr}}
\renewcommand{\oopenBr}{{\openBr}}

\newcommand{\ccloseBr}{{\closeBr} {\closeBr}}
\renewcommand{\ccloseBr}{{\closeBr}  \!\!\!\!\!> }
\renewcommand{\ccloseBr}{{\closeBr}}

%specs at OOPSLA
\newcommand\calls[4]{\langle #1\ {\color{blue}\texttt{calls}}\ #2.#3(#4) \rangle}

%%% PRE-POST condiitons 
\newcommand{\mprepost}[6]{\ensuremath{ \openBr\, #1\, \closeBr\, #2\!::\!#3(\overline{#4:#5})\, \openBr\, #6\, \closeBr }}
\newcommand{\mprepostN}[7]{\ensuremath{ \openBr\, #1\, \closeBr\, #2\!::\!#3(\overline{#4:#5})\, \openBr\, #6\, \closeBr }\, \prsrv\, \openBr #7 \closeBr}
\newcommand{\mprepostNTwo}[7]{{\ensuremath{\begin{array}{l} \openBr\, #1\, \closeBr\, #2\!::\!#3(\overline{#4:#5})\, \openBr\, #6\, \closeBr \\
\strut \ \hspace{1.5cm} \ \prsrv\, \openBr #7 \closeBr\end{array}}}}

\newcommand{\mprepostLong}[5]{\ensuremath{ \openBr\, #1\, \closeBr\, #2\!::\!#3(#4)\, \openBr\, #5\, \closeBr }}
\newcommand{\mprepostLongN}[6]{\ensuremath{ \openBr\, #1\, \closeBr\, #2\!::\!#3(#4)\, \openBr\, #5\, \closeBr  \, \prsrv\, \openBr #6 \closeBr}}


\newcommand{\prsrv}{\,\parallel\,}%{{\texttt{inv}}}

\newcommand{\triple}[3]{\ensuremath{ \{\, #1 \,  \}\ #2  \{\, #3   \, \}}}
\newcommand{\quadruple}[4]{\ensuremath{ \{\, #1 \,  \}\ #2  \{\, #3   \, \} \, \prsrv\, \{\, #4   \, \} }}

\newcommand{\sprepostShort}[6]{
\begin{tabular}{lcl}
${#1}$  &$\triangleq$ & $\openBr\, #2\, \closeBr\, $
\\ 
& &  $\strut \ \ \  \ \ \ #3 :: #4({#5}) $ 
\\
& &  $ \openBr\, #6\, \closeBr\   {\prsrv\  \openBr {...} \closeBr}$
\end{tabular}
}

 \newcommand{\sprepost}[7]{
\begin{tabular}{lcl}
${#1}$  &$\triangleq$ & $\openBr\, #2\, \closeBr\, $
\\ 
& &  $\strut \ \ \  \ \ \ #3 :: #4({#5}) $ 
\\
& &  $ \openBr\, #6\, \closeBr\   {\prsrv\  \openBr #7 \closeBr } $
\end{tabular}
}

 \newcommand{\sprepostLB}[7]{
\begin{tabular}{lcl}
${#1}$  &$\triangleq$ & $\openBr\, #2\, \closeBr\, $
\\ 
& &  $\strut \ \ \  \ \ \ #3 :: #4({#5}) $ 
\\
& &  $ \openBr\, #6\, \closeBr $  \\
& &   $ \sdred{\prsrv\  \openBr #7 \closeBr}  $
\end{tabular}
}
\newcommand{\ruleExtCallB}{{\sc{Ext\_Call\_B}}}




%-------------------------------------------------  Modules -----------------------------------------------------------
\newcommand{\ModParam}[1]{\prg{M}\ensuremath{_{{#1}}}\xspace} % {\prg{Mod}\ensuremath{_{\prg{#1}}}\xspace}
\newcommand{\ModA}{\ModParam{\textit{good}}}
\newcommand{\ModB}{\ModParam{\textit{bad}}}
\newcommand{\ModC}{\ModParam{\textit{fine}}} %{\ModParam{better}}
\newcommand{\ModD}{\ModParam{best}}
\newcommand{\ModExt}{\ModParam{ext}}
\newcommand{\Mtwo}{\overline{M}}
\renewcommand{\ModD}{\ModParam{unp}}
\newcommand{\ModE}{\ModParam{prt}}
\newcommand{\Mshop}{$M_{{\textit{shop}}}$\xspace}

\newcommand{\Ao}{A_{o}}
\newcommand{\Ain}{A_{in}}
\newcommand{\Aout}{A_{out}}


%-------------------------------------------------  Assertions -----------------------------------------------------------
\newcommand{\extThis}{\prg{extl}}
\newcommand{\intThis}{\prg{intl}}
\newcommand{\pubMeth}{\prg{pub}}
\newcommand{\Formals}[2]{Prms(#1,#2)} 

\newcommand{\satisfiesA}[3]{\satisfies{#1 , #2}{#3}}
\newcommand{\notsatisfies}[2]{#1 \nvDash #2}
\newcommand{\satisfies}[2]{#1 \models #2}


%-------------------------------------------------   Executions -------------------------------------------------  

\newcommand{\leadstoN}{\dashrightarrow} % {\rightarrow} % \dashrightarrow}  
\newcommand{\reduction}[4]{#1 ; #2,\ #3 \curvearrowright #4}
\newcommand{\redsymb}{\curvearrowright}
\newcommand{\reductions}[4]{#1 ; #2,\ #3\ \curvearrowright^* #4}
\newcommand{\exec}[3]{#1, #2 \leadstoN\ #3}
\newcommand{\bd}{_{sc}}

\newcommand{\eval}[4]{#1, #2, #3 \hookrightarrow #4}

%----------------------------------------------- relations ---------------------------------------------------------

\newcommand{\stronger}[3]{#1\, \models\, #2\,  \sqsubseteq\, #3}   
\newcommand{\strongerEq}[3]{#1 \models #2 \langlel \equiv \rangle #3}
\newcommand{\strongerEqI}[3]{#1 \vdash #2 \langlel \equiv \rangle #3}
\newcommand{\promises}[2]{{\ensuremath \vdash \ \ #1\ \   \kw{:}\ \  #2}}

 
%----------------------------------------------- Lookup ---------------------------------------------------------
\newcommand{\class}[2]{\textit{classOf}(#1, #2)}

\newcommand{\meth}[3]{\textit{Meth}(#1, #2, #3)}

\newcommand{\interpret}[2]{\lfloor #2 \rfloor_{#1}}
\newcommand{\initial}[1]{\textit{Initial}(#1)}

\newcommand{\arising}[2]{\mathcal{A}\!\textit{rising}(#1, #2)}
\newcommand{\F}{\hspace{-1pt}F\hspace{-1pt}}
\newcommand{\VS}{\hspace{-1pt}V\hspace{-1pt}}
\newcommand{\fv}{{\F}v} 
\newcommand{\vs}{{\VS}s}

\newcommand\rtrns[3]{\{#1\}\ #2\ \texttt{returns}\ #3}

\newcommand{\Same}[4]{{SameModule(#1,#2,#3,#4)}}
%\newcommand\ifthenelse[3]{\texttt{if}\ #1\ \texttt{then}\ #2\ \texttt{else}\ #3}


\newcommand\encapsulated[1]{\langlel {\color{blue}\texttt{encapsulated}}\ #1 \rangle}

\newcommand{\kw}[1]{\mathbf{#1}}
%\newcommand{\langlel}{}
\newcommand{\ranglel}{}
\newcommand{\rangler}{}

\newcommand{\openBr}{\{} %{{\llparenthesis}} % {\{\!\!\{} %
\newcommand{\closeBr}{\}} %{{\rrparenthesis}} % {\}\!\!\}} % 
\newcommand{\insideleft}{\langle\!\!\langle} % {[\!\!|} %{\lfloor} %{\prec \!\! \prec}
\newcommand{\insideright}{\rangle\!\!\rangle} % {|\!\!]} % {\rfloor}% {\succ \!\! \succ^{prt}}
\newcommand{\insiderightAbs}{\insideright}
\newcommand{\protFromArrow}{\leftarrow\!\!\!\!\--\!\!\!\!\!\!\times\ \ } % {\dashleftarrow\!\--\!\!\!\!\!\!\!\times\ \ }
\newcommand{\insiderightfrom}{\insideright\!\!\protFromArrow\!\!}%{\succ \!\! \succ^{prt-frm}}
\newcommand{\insidef}[1]{ [\!\![ #1 ]\!\!]  }
%{{\langle\!\!\langle\!\![ #1 ]\!\!\ \rangle\!\!\rangle}}


%----------------------------------------- Assertions --------------------------------------------------
\newcommand\access[2]{\langle #1\ {\color{blue}\texttt{access}}\ #2 \rangle}
%%\newcommand\access[2]{SOPHIA\langle #1\ {\color{blue}\texttt{access}}\ #2 \rangle AIHPOS}
\newcommand{\protectedFrom}[2]{\ensuremath{\insideleft  #1 \insiderightfrom  #2}}
\newcommand{\accessedBy}[2]{\ensuremath{ #1 \leftarrow  #2}}
\newcommand{\noDirAccess}[2]{\ensuremath{ #1\protFromArrow  #2}}
\newcommand\inside[1]  {\ensuremath{\insideleft  #1 \insiderightAbs}}


% obsoltete
% \newcommand{\Relevant}[3]{\ensuremath{\,Reachbl(\,#1,#2,#3\,)}}
%\newcommand{\LRelevant}[2]{\ensuremath{\,Loc\_Reachbl(\,#1,#2\,)}}
%\newcommand{\LRelevantK}[3]{\ensuremath{\,Loc\_Reachbl(\,#1,#2, #3\,)}}
%\newcommand{\NotLRelevantK}[3]{\ensuremath{\,\neg (Loc\_Reachbl(\,#1,#2, #3\,))}}
\newcommand{\LReachable}{LocRchbl}
\newcommand{\Relevant}[2]{\ensuremath{Rchbl(#1,#2)}}
\newcommand{\LRelevantO}[1]{\ensuremath{\LReachable(#1)}}
\newcommand{\LRelevantKO}[2]{\ensuremath\LReachable(#1,#2)}
\newcommand{\NotLRelevantKO}[3]{\ensuremath{\,\neg (\LReachable(#1,#2)}}

\newcommand{\SpecOf}[1]{\mathcal S\! pec(#1)}

\newcommand\internal[1]{#1:\prg{intl}}
\newcommand\external[1]{#1:\prg{extl}}

\newcommand{\Reach}[3]{\ensuremath{Reach(#1,#2)_{#3}}}


\newcommand\encaps[1]{{\ensuremath Enc(  #1  )}} % {{\ensuremath Encps(\, #1\, )}}
\newcommand{\Stable}[1]{{\ensuremath Stbl( #1  )}}
\newcommand{\Pos}[1]{{\ensuremath Stb^+( #1 )}}
\newcommand{\Neg}[1]{{\ensuremath Stb^-( #1   )}}
%----------------------------------------------- proves  ---------------------------------------------- 
\newcommand\proves[2]{#1\ \vdash\ #2}
\newcommand\hproves[4]{#1\ \vdash\ \{\,#2\, \} #3  \{\,#4\, \} }
\newcommand\hprovesN[5]{#1\ \vdash\ \{\,#2\, \} #3  \{\,#4\, \}\, \prsrv\, \{\, #5 \, \} }

\newcommand\hprovesTwoLines[4]{#1\ \vdash\ \{\,#2\, \} \\
~ \strut \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \  #3\\
~ \strut \ \ \ \ \ \ \ \ \ \ \ \ \ \   \{\,#4\, \} }

%----------------------------------------------- execution---------------------------------------------- 

\newcommand{\leadstoOrig}[3]{\ensuremath{#1;#2\! \leadstoN\! {#3}}}
\newcommand{\leadstoOrigStar}[3]{\ensuremath{#1;#2\! \leadstoN^*\! {#3}}}

\newcommand{\leadstoRec}[4]{\ensuremath{#1, #2 \leadstoN_{#3} #4}}

\newcommand{\bounded}{\rightsquigarrow}
\newcommand{\boundedTrans}{{\bounded^*}} %{\bounded\!\!\!\!\rhd} % {\bounded\!\!\Yright} %{\twoheadrightarrow}
\newcommand{\leadstoBounded}[3]{\ensuremath{#1;\,  {#2}  \bounded #3}}
\newcommand{\notLeadstoBounded}[3]{\ensuremath{#1;\, {#2}  \not\bounded #3}}


\newcommand{\notLeadstoBoundedStar}[3]{\ensuremath{#1;\,  {#2} \not\!\!\!\boundedTrans #3}}
\newcommand{\leadstoBoundedThree}[4]{\ensuremath{(#1, #3);\,  {#2}  \bounded #4}}
\newcommand{\notLeadstoBoundedThree}[4]{\ensuremath{(#1, #3);\, {#2}  \not\bounded #4}}
\newcommand{\notLeadstoBoundedStarThree}[4]{\ensuremath{(#1, #3);\,  {#2} \not\boundedTrans #4}}

\newcommand{\leadstoBoundedStar}[3]{\ensuremath{#1;\, {#2}  \boundedTrans #3}}
\newcommand{\leadstoBoundedStarFin}[3]{\ensuremath{#1;\, {#2}  \boundedTrans\!\!_{\mathit{fin}}\, #3}}
\newcommand{\leadstoBoundedStarThree}[4]{\ensuremath{(#1, #3);\, {#2}  \boundedTrans #4}}

\newcommand{\externalexec}{\extThis}
\newcommand{\leadstoBoundedThreeStarExt}[4]{\ensuremath{(#1,\, {#2});  #3\boundedTrans\!\!_{e}\, #4}}

\newcommand{\leadstoBoundedThreePub}[4]{\ensuremath{(#1,\, {#2});  #3 \boundedTrans\!_{p}\, #4}}
\newcommand{\WithPub}[4] % {\ensuremath{(#1);  #2 \bounded\!\!\! \!\!\!\!\!^{#4}\ \ ^*\!\!\!\!_{p}\, #3}}
% {\ensuremath{(#1);  #2 {\overset{#4\,}{\boundedTrans}} \!\!\!_{p}\, #3}}
{\ensuremath{(#1);  #2}{\boundedTrans}  \!\!\!_{p}\, #3 {\textbf{pb}}\, {#4\,} }

\newcommand{\leadstoBoundedPub}[3]{\ensuremath{#1;  #2 \boundedTrans\!\!\!\!_{p}\, #3}}

\newcommand{\leadstoBoundedThreeExtPub}[4]{\ensuremath{(#1,\, {#2});  #3 \boundedTrans\!_{e,p}\, #4}}
\newcommand{\WithExtPub}[5]{\ensuremath{(#1,\, {#2});  #3 {\boundedTrans}} \!\!\!_{e,p}\, #4\,  {\textbf{pb}}\, {#5} }

\newcommand{\leadstoBoundedExtPub}[3]{\ensuremath{#1;  #2 \boundedTrans\!\!\!\!_{e,p}\, #3}}

\newcommand{\Values}{\ensuremath{{\mathcal V}\!\mathit{al}}}

\newcommand{\extract}[1]{\ensuremath{{\mathcal I}\!nvs(#1)}}
\newcommand{\specs}[1]{\ensuremath{Specs(#1)}}%{\ensuremath{{\mathcal S}\!pecs(#1)}}

%\newcommand\wrapped[1] {\texttt{inside}( #1 )}

\newcommand{\synbar}{\;\; | \;\;}


%%-----------------------------------------------------  Languages  -----------------------------------------------------
\newcommand{\Loo}{\ensuremath{{{\tt {TooL}}}}\xspace}
\newcommand{\LangOO} {\ensuremath{{\mathcal L}{^{\tt {oo}}}}\xspace}
\newcommand{\SpecLang}{\ensuremath{{\mathcal L}{^{{spec}}}}\xspace}
\newcommand{\AssertLang}{\ensuremath{{\mathcal L}{^{{assrt}}}}\xspace}
\newcommand{\Nec}{\textit{Necessity}\xspace}  
\newcommand{\SpecO}{\textit{Assert}\xspace}  

\newcommand{\Chainmail}{\textit{SpecX}\xspace}


%------------------------------------------------------- FOR DEEP SATISFACTION ----------------------------------------------------------------
\newcommand{\depth}[1]{|#1|}
\newcommand{\DepthFs}[1]{|#1|}
\newcommand{\DepthSt}[1]{|#1|}
\newcommand{\RestictTo}[2]{#1[#2]}
\newcommand{\RestrictTo}[2]{\RestictTo{#1}{#2}}
\newcommand{\measure}[2]{[\!\![\, #1 ]\!\!]\,_{#2}}

\newcommand{\inferd}{\rightarrow\deep\ }

\newcommand{\deep}{\!\!\!\!_{_{stng}}}  %{\!\!\!\!_{_{\circ}}}
\newcommand{\modelsD}{\models\deep\ } %\downarrow \ } %\!\!\!\!_{_\bullet}\ }
\newcommand{\satDAssertFrom}[4]{\ensuremath{#1,#2 ,{#3} \models {#4} }}
\newcommand{\notSatDAssertFrom}[4]{\ensuremath{#1,#2 ,{#3} \not\models {#4} }}

\newcommand{\satDAssertQuadrupleFrom}[6]{\ensuremath{#1;#2  \modelsD \, \{\, #4\,\}\, #3\, \{\, #5\,\}  \prsrv  \{\, #6\,\} }}
\newcommand{\satisfiesD}[2]{\ensuremath{#1   \modelsD  #2 }}
\newcommand{\notSatisfiesD}[2]{\ensuremath{#1   \not\modelsD  #2 }}

 \newcommand{\satAssertQuadruple}[6]{\ensuremath{#1; #2\, \models \, \{\, #3\,\}\, #4 \, \{\, #5\,\}  \prsrv   \{\, #6\,\} }}
 
  \newcommand{\internalPaths}[1]{#1:\prg{intl*}}

% -------------------------------------------------  PUSH and POP ------------------------------------------------- 

\newcommand{\pushSymbol}{\, {\triangledown}\, }  % {\bigtriangledown}  
\newcommand{\pushSymbolL}  {\bigtriangledown}  
\newcommand{\popSymbol}{\, {\vartriangle}\, }  %{\bigtriangleup} 
\newcommand{\popSymbolL}{\bigtriangleup} 
\newcommand{\pushSymbolA}{\!-\!\!\!\,\!{\triangledown}}
\newcommand{\pushSymbolAA}{\pushSymbolA}
\newcommand{\Pushes}[3] {\ensuremath{  \overline{#2} \pushSymbolL  #1}}
\newcommand{\Pop}[2] {\ensuremath{ #1 \popSymbolL  #2}}
\newcommand{\Pops}[3] {\ensuremath{ #1,   \overline{#2} \popSymbolL  #3}}
\newcommand{\va}{\ensuremath{w}}
\newcommand{\PushA}[4] {\ensuremath{   {\overline{#3}} \vdash #2 \pushSymbolA  #4  }}
\newcommand{\PushALong}[4] {\ensuremath{     {#3} \vdash #2  \pushSymbolA  #4  }}
\newcommand{\PopA}[2]{  #1   \popSymbol #2}
\newcommand{\PopAA}[3]{ \PopA {#2} {#3}}

\newcommand{\FIXSymbolA}{\ensuremath{ { } \pushSymbolA         { }  }}
\newcommand{\pushSymbolInText}{\ensuremath{} {-\!\,\!{\triangledown}} {} }


%The opposite order at the end of this file99
\newcommand{\PushAS}[2] {\ensuremath{ {#2} \pushSymbolA   \overline{#1} }} % for assertionbs
\newcommand{\PushASLong}[2] {\ensuremath{  #2  \pushSymbolA #1}}
\newcommand{\PushASLongG}[2] {\ensuremath{  #2 \npgreen{ \pushSymbolA}  \npgreen{ #1}}}
\newcommand{\PushS}[2] {\ensuremath{ \ {#2} \pushSymbol   \overline{#1} }} % for states and variables
\newcommand{\PushSF}[2] {\ensuremath{ \ {#2} \pushSymbol  {#1} }}  % for states and frames
\newcommand{\PushSLong}[2] {\ensuremath{  #2  \pushSymbol #1}}
\newcommand{\PopAS}[2] {\ensuremath{   {#2}   \popSymbol \overline{#1} }} % for assertionbs
\newcommand{\PopASLong}[2] {\ensuremath{ #2   \popSymbol #1}}
\newcommand{\PopS}[2] {\ensuremath{   {#2}   \popSymbol  \overline{#1} }} % for states
\newcommand{\PopSLong}[2] {\ensuremath{ #2   \popSymbol #1}}

\newcommand{\EarlierS}[2] {\ensuremath{ {#1}   \sqsubseteq {#2}}}
\newcommand{\NotEarlierS}[2] {\ensuremath{ {#1}   \not\sqsubseteq {#2}}}

\renewcommand{\PopA}[3]{\ensuremath{#1}\vdash {#2}  \popSymbol {#3}}
\renewcommand{\PopAA}[3]{ \PopA {#1} {#2} {#3}}


%----------------------------------------------------- Syntax Def  ---------------------------------------------	
	
% Syntax Construct
\makeatletter 

\newenvironment{syntax}
    {
    \begin{array}{lllr}
    }
    { 
    \end{array}
    }
    
\newcommand{\syntaxID}[2]{
		#1 & & & \text{\bf{#2}}\\
}
    
\newcommand{\syntaxInSet}[3]{
		#1 & \in & #2 & \text{\bf{#3}}\\
}

\newcommand{\syntaxElement}[3]{%
		#1 & ::= & #3 & \text{\bf{#2}} \\
			\@syntaxEntry
}

\newcommand\@syntaxEntry{\@ifnextchar\endSyntaxElement{\@syntaxElementEnd}{\@syntaxEntryCheck}}

\newcommand\@syntaxEntryCheck[1]{%
  \@syntaxEntryMake{\synbar #1}
  \@syntaxEntry
}
\newcommand\@syntaxEntryMake[1]{%
	& & #1 & \\
	}
\newcommand\@syntaxElementEnd[1]{
	\vspace*{-\bigskipamount}
	} 
\makeatother

% Syntax Line
\makeatletter

\newcommand{\syntaxline}[1]{%
		#1 \@syntaxLineNext
}
\newcommand\@syntaxLineNext{\@ifnextchar\endsyntaxline{\@syntaxLineEnd}{\@syntaxLineCheck}}

\newcommand\@syntaxLineCheck[1]{%
  \@syntaxLineMake{#1}
  \@syntaxLineNext
}
\newcommand\@syntaxLineMake[1]{%
	\synbar #1
	}
\newcommand\@syntaxLineEnd[1]{}
\makeatother

%-------------------------------------------------  listing set of keywords  -------------------------------------------------

\lstset{ % General setup for the package
	language=Java,
	basicstyle=\footnotesize\sffamily\ttfamily,
 	numberstyle=\tiny,
    numbers=left,
 	frame = bottomline,
	tabsize=4,
	columns=fixed,
	showstringspaces=false,
	showtabs=false,
	keepspaces,
	morekeywords={external, this, true, false, field, method, public, private, module, presumes, achieves, requires, ensures, PRE, POST, ghost, bool, int, constr, bool, int, confined, then, ENSURES, MODIFIES},
	commentstyle=\color{red},
	keywordstyle=\color{blue}
}

\lstdefinelanguage{Chainmail}{
  basicstyle=\footnotesize\sffamily\ttfamily,
  morekeywords={calls, external, internal, access, this, ENSURES, MODIFIES, PRE, POST, method, field, ghost, class, module, confined, void, if, then, else,
                from, onlyThrough, onlyIf, next, to, true, false, through, bool, public, private, int, external},
  sensitive=false,
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]",
}

%----------------------------------------------------------- Keywords ---------------------------------------------------
\newcommand\new[2]{\texttt{new}\ #1(#2)}
\newcommand\return[1]{\texttt{return}\ #1}
\newcommand\this{\texttt{this}}
\newcommand\true{\texttt{true}}
\newcommand\false{\texttt{false}}
\newcommand\nul{\texttt{null}}
\newcommand\all[2]{\forall #1.#2} % {\forall #1.[#2]}
\newcommand\ex[2]{\exists\ #1.#2} %{\exists\ #1.[#2]}

 %------------------------------------------------------------ inference  rulles ----------------------------------

\newcommand{\inferruleSD}[3]{
	\begin{array}{c}
		\strut \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {{\mbox{#1}}}
		\\
		#2 \\
		\hline
		#3
	\end{array}
	}
	
\newcommand{\inferruleSDNarrow}[3]{
	\begin{array}{c}
		\strut  \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ {{\mbox{#1}}}
		\\
		#2 \\
		\hline
		#3
	\end{array}
	}

\newcommand{\inferruleNoName}[2]{
	\begin{array}{c}
			% \strut \hspace{1.5cm} 
			{#1} \\
		\hline
		% \strut \hspace{1.5cm} 
		#2
	\end{array}
	}
	
\newenvironment{customquote}
  {\vspace{-0.35em} % Reduce vertical space before
   \begin{list}{}%
     {\setlength{\leftmargin}{2em} % Adjust left margin
      \setlength{\rightmargin}{0em}} % No right margin
     \item[]}
  {\end{list}
   \vspace{-0.35em}}
	
%----------------------------------------  Proof layout --------------------------------------------------------
	
%\newcommand{\proofsteps}[1]{%
%			\vspace{-1.5mm}
%			\textbf{#1}:\\
%			\@proofStep
%}
%
%\newcommand\@proofStep{\@ifnextchar\endproofsteps{\@proofstepEnd}{\@proofStepCheck}}
%
%\newcommand\@proofStepCheck[1]{%
%  \@proofStepMake{#1}
%  \@proofStep 
%}
%
%\newcommand\@proofStepMake[1]{%
%		#1 \\
%	}
%\newcommand\@proofstepEnd[1]{\vspace{-3mm}}
%
%\makeatother
%
%\newenvironment{proofexample}
%    {
%    \begin{minipage}{\textwidth}
%    \tiny
%    \begin{proofBox}{white}{black}
%    }
%    {
%    \end{proofBox}
%    \end{minipage}
%    }
    


%----------------------------------------  Push - in different order. --------------------------------------------------------

%\newcommand{\PushAS}[2] {\ensuremath{ \overline{#1} \pushSymbol  #2}} % for assertionbs
%\newcommand{\PushASLong}[2] {\ensuremath{  #1  \pushSymbol #2}}
%\newcommand{\PushS}[2] {\ensuremath{ \overline{#1} \pushSymbol  #2}} % for states
%\newcommand{\PushSLong}[2] {\ensuremath{  #1  \pushSymbol #2}}
%\newcommand{\PopAS}[2] {\ensuremath{  \overline{#1}   \popSymbol #2}} % for assertionbs
%\newcommand{\PopASLong}[2] {\ensuremath{ #1   \popSymbol #2}}
%\newcommand{\PopS}[2] {\ensuremath{  \overline{#1}   \popSymbol #2}} % for states
%\newcommand{\PopSLong}[2] {\ensuremath{ #1   \popSymbol #2}}

%%% FROM PREVIOUS PAPER

%\newcommand\trans{\mathlarger{\mathlarger \leadstoN}}
%\newcommand\intstep{\hspace{1.5mm}{\raisebox{3pt}{$\bullet$}}\hspace{-1.5mm}{\hookrightarrow}}
%\newcommand\en{\hspace{1.5mm}{\raisebox{0pt}{$\bullet$}}\hspace{-4mm}{\hookrightarrow}}
%\newcommand\oi{\hspace{1mm}{\raisebox{1pt}{$\bullet$}}\hspace{-1mm}{\trans}}
%\newcommand\ot{\hspace{2mm}{\raisebox{1pt}{$\bullet$}}\hspace{-3mm}{\trans}}
%\newcommand\otAlt{\hspace{2mm}{\raisebox{0.5pt}{$\bullet$}}\hspace{-2.75mm}{\trans}}
%\newcommand\mut[3]{\langlel #1\ \texttt{mut}\ #2.#3 \rangle}
%\newcommand\gives[3]{\langlel #1\ \texttt{gives}\ #2\ \texttt{to}\ #3 \rangle}
%\newcommand\exposes[2]{#1\ \texttt{exposes}\ #2}
%\newcommand\univ{U}
%\newcommand\onlyIf[3]{{\color{blue}\texttt{from}}\ #1\ {\color{blue}\texttt{to}}\ #2\ {\color{blue}\texttt{onlyIf}}\ #3}
%\newcommand\oiInternal[4]{#1\ {\color{blue}\texttt{to}}\ #2\ {\color{blue}\texttt{through}}\ #3\ {\color{blue}\texttt{onlyIf}}\ #4}
%\newcommand\ensures[3]{#1,\ #2\ \en\ #3}
%\newcommand\onlyThrough[3]{{\color{blue}\texttt{from}}\ #1\ {\color{blue}\texttt{to}}\ #2\ {\color{blue}\texttt{onlyThrough}}\ #3}
%\newcommand\onlyIfSingle[3]{{\color{blue}\texttt{from}}\ #1\ {\color{blue}\texttt{next}}\ #2\ {\color{blue}\texttt{onlyIf}}\ #3}
%\newcommand\onlyIfProof[4]{{\color{blue}\texttt{from}}\ #1\ \vdash\ #2,\ #3\ \texttt{only if}\ #4}
%\newcommand\onlyThroughProof[4]{{\color{blue}\texttt{from}}\ #1\ \vdash\ #2,\ #3\ \texttt{only if}\ #4}
%\newcommand\hoare[3]{\{#1\}\ #2\ \{#3\}}
%\newcommand\hoareIf[4]{#1,\ #2,\ \{#3\}\ \intstep\ #4}

%\newcommand{\Spec}[1]{\ensuremath{\boldmath{S}_{\prg{#1}}}\xspace} % {{\ensuremath{{\mathcal{S}}_{\prg{#1}}}}\xspace}
%\newcommand{\Sadapt}{\Spec{to\_dcr\_thr\_call}}
%%(S$_{\text{nxt\_red\_if\_tran}}$)\xspace}
%\newcommand{\Scorrect}{\Spec{correct}\xspace} % {(S$_{\text{correct}}$)\xspace}
%\newcommand{\SrobustA}{\Spec{robust$\_{\prg{1}}$}} %{(S$_{\text{robust}_1}$)\xspace}  % SD we should  not have subscripts in subscriptts!
%\newcommand{\SrobustB}{\Spec{robust$\_{\prg{2}}$}} % {(S$_{\text{robust}_2}$)\xspace}
%\newcommand{\SRobustNextAcc}{\Spec{nxt\_dcr\_if\_acc}\xspace}
%\newcommand{\SRobustifAcc}{\Spec{to\_dcr\_if\_acc}\xspace}
%\newcommand{\SRobustThroughAcc}{\Spec{to\_dcr\_thr\_acc}\xspace}
%\newcommand{\SRobustNextCall}{\Spec{nxt\_dcr\_if\_call}\xspace}
%\newcommand{\SRobustToCall}{\Spec{to\_dcr\_if\_call}\xspace}
%\newcommand{\SRobustThroughCall}{\Spec{to\_dcr\_thr\_call}\xspace}
%\newcommand{\SRobustIfAcc}{\Spec{to\_dcr\_if\_acc}\xspace}

%\newcommand{\TwoStates}[2]{\ensuremath{\FirstState{#1}\,\SecondState{#2}}}

%\newcommand{\initialStateNode}[3]{
%   \node[draw=red, label=above:#1] (#2) {#3};
%}
%\newcommand{\stateNode}[4]{
%   \node[draw=red, label=above:#1] (#2) [#3] {#4};
%}
%\newcommand{\etcNode}[2]{
%   \node[] (#1) [#2] {...};
%}
%
%\newtcolorbox{proofBox}[3][]
%{
%  colframe = #3,
%  colback  = #2,
%  #1,
%}

%\newcommand{\leadstoUp}{\leadstoN\!\!\succ}

%\newcommand\hoareEx[3]{\noindent\{\ \texttt{#1}\ \}\\ \hspace*{5pt} \texttt{#2} \\ \hspace*{5pt} \{\ \texttt{#3}\ \}}
%\newcommand\onlyIfEx[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{to} \texttt{#2} \\ \hspace*{5pt} \blue{onlyIf} \texttt{#3}}
%\newcommand\onlyIfExAlt[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{to} \texttt{#2}  \hspace*{5pt} \blue{onlyIf} \texttt{#3}}
%\newcommand\onlyIfSingleEx[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{next} \texttt{#2} \\ \hspace*{5pt} \blue{onlyIf} \texttt{#3}}
%\newcommand\onlyIfSingleExAlt[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{next} \texttt{#2} \hspace*{5pt} \blue{onlyIf} \texttt{#3}}
%\newcommand\onlyThroughEx[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{to} \texttt{#2} \\ \hspace*{5pt} \blue{onlyThrough} \texttt{#3}}
%\newcommand\onlyThroughExAlt[3]{\blue{from} \noindent\texttt{#1}\\ \hspace*{5pt} \blue{to} \texttt{#2}  \hspace*{5pt} \blue{onlyThrough} \texttt{#3}}
%\newcommand\case[2]{\textbf{Case #1:}\\ #2}
%
%\newcommand{\proofstepwithrule}[2]{
%	\begin{minipage}{0.75\textwidth}
%		\hrulefill\\
%		#1 \\
%		\vspace{-1mm}
%	\end{minipage} \hfill
%	\begin{minipage}{0.2\textwidth}
%		#2
%	\end{minipage}	
%}
