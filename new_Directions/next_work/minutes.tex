%% For double-blind review submission, w/o CCS and ACM Reference (max submission space)
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For double-blind review submission, w/ CCS and ACM Reference
\documentclass[acmsmall,review,anonymous]{acmart}\settopmatter{printfolios=true}
%% For single-blind review submission, w/o CCS and ACM Reference (max submission space)
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true,printccs=false,printacmref=false}
%% For single-blind review submission, w/ CCS and ACM Reference
%\documentclass[acmsmall,review]{acmart}\settopmatter{printfolios=true}
%% For final camera-ready submission, w/ required CCS and ACM Reference
%\documentclass[acmsmall]{acmart}\settopmatter{}
\usepackage{enumitem}
\usepackage{soul}
% \usepackage{ amssymb }

%% Journal information
%% Supplied to authors by publisher for camera-ready submission;
%% use defaults for review submission.
\acmJournal{PACMPL}
\acmVolume{1}
\acmNumber{OOPSLA} % CONF = POPL or ICFP or OOPSLA
\acmArticle{1}
\acmYear{2022}
\acmMonth{1}
\acmDOI{} % \acmDOI{10.1145/nnnnnnn.nnnnnnn}
\startPage{1}

%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission;
%% use 'none' for review submission.
\setcopyright{none}
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\copyrightyear{2018}           %% If different from \acmYear

%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
%% Note: author/year citations are required for papers published as an
%% issue of PACMPL.
\citestyle{acmauthoryear}   %% For author/year citations


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Note: Authors migrating a paper from PACMPL format to traditional
%% SIGPLAN proceedings format must update the '\documentclass' and
%% topmatter commands above; see 'acmart-sigplanproc-template.tex'.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%% Some recommended packages.
\usepackage{booktabs}   %% For formal tables:
                        %% http://ctan.org/pkg/booktabs
\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
                        %% http://ctan.org/pkg/subcaption
 \usepackage{ stmaryrd }                       

\usepackage{relsize}
\usepackage{mathpartir}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{listings}
\usepackage{xspace}
\usepackage{definitions}
\usepackage{multirow,bigdelim}
\usepackage{pbox}
\usepackage{courier}
\usepackage{soul}
\usepackage{centernot}

\newcommand\multibrace[3]{\rdelim\}{#1}{3mm}[\pbox{#2}{#3}]}

\definecolor{ferngreen}{rgb}{0.31, 0.47, 0.26}
\newcommand{\kjx}[1]{{\color{ferngreen}{#1}}}
\newcommand{\scd}[1]{{\color{blue}{#1}}}
%\newcommand{\sdN}[1]{{\color{dkgreen}{#1}}}
%\newcommand{\jm}[1]{{\color{magenta}{JM: #1}}}
\newcommand{\sdcomment}[1]{{\ensuremath{\blacksquare}}\footnote{\color{dkgreen}{SD: #1}}}
\newcommand{\secomment}[1]{{\ensuremath{\blacksquare}}\footnote{\se{#1}}}
\newcommand{\jncomment}[1]{{\ensuremath{\blacksquare}}\footnote{\kjx{#1}}}

\newcommand{\sd}[1]{{\color{blue}{#1}}}
 \newcommand{\tobyM}[1]{#1} %[1]{{\color{purple}{Toby: #1}}}
\newcommand{\se}[1]{{\color{green}{#1}}}
\definecolor{amber}{rgb}{1.0, 0.75, 0.0}
\definecolor{amethyst}{rgb}{0.6, 0.4, 0.8}

\newcommand{\ponders}[3]{\marginpar{\tiny\itshape\raggedright\textcolor{#2}{\textbf{#1:} #3}}\ignorespaces}
\marginparwidth=1.6cm \marginparsep=0cm
\newcommand{\TODO}[1]{} % {{\color{red}#1}}
\newcommand{\sophia}[1]{{\color{blue}#1}}
\newcommand{\toby}[1]{} % {\ponders{Toby}{purple}{#1}}
\newcommand{\susan}[2][]{\ponders{Susan}{brown}{#1} \textcolor{brown}{#2}\xspace}
\newcommand{\james}[1]{\ponders{James}{orange}{#1}}
\newcommand{\jm}[2][]{\ponders{Julian}{magenta}{#1} \textcolor{magenta}{#2}\xspace}
\newcommand{\mrr}[2][]{\ponders{Matthew Ross}{offblue}{{#1}} \textcolor{offblue}{{#2}}\xspace}
\newcommand{\sdr}[2][]{\ponders{SD:}{blue}{#1} \textcolor{blue}{#2}\xspace}
\newcommand{\sdNr}[2][]{\ponders{SD:}{amber}{#1} \textcolor{amethyst}{#2}\xspace}
\newcommand{\sdN}[1]{\textcolor{amethyst}{#1}\xspace}
\newcommand{\mrrz}[1]{\textcolor{offblue}{{#1}}\xspace}
\newcommand{\Mrr}[2][]{\ponders{Matthew Ross}{teal}{{#1}} \textcolor{teal}{{#2}}\xspace}
\newcommand{\Mrrz}[1]{\textcolor{teal}{{#1}}\xspace}
\newcommand{\julian}[1]{\textcolor{green}{#1}\xspace}
\newcommand{\sdM}[1]{\textcolor{amethyst}#1\xspace}

\newcommand{\sophiaPonder}[2][]{\ponders{Sophia}{blue}{#1} \textcolor{blue}{#2}\xspace}
\renewcommand{\sophia}[2][]

\newcommand{\sdfootnote}[1]{\footnote{#1}}



\begin{document}

%% Title information
%\title[Specification and Proof of Necessary Conditions]{Specification
%and Proof of Necessary Conditions}         %% [Short Title] is
%optional;
%\title{Necessity Specifications are Necessary}
\title{Minutes from meetings}
 \author{ }
 \orcid{0000-0003-3098-3901}             %% \orcid is optional
\affiliation{ }
\email{xyx}
    \begin{abstract}
 problem problem  problem problem  problem problem  problem problem   
-- and then --- 
solution  solution solution  solution solution  s 
-- and then --
even better even better even better even better even better \end{abstract}


%% 2012 ACM Computing Classification System (CSS) concepts
%% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
\begin{CCSXML}
<ccs2012>
<concept>
<concept_id>10011007.10011006.10011008</concept_id>
<concept_desc>Software and its engineering~General programming languages</concept_desc>
<concept_significance>500</concept_significance>
</concept>
<concept>
<concept_id>10003456.10003457.10003521.10003525</concept_id>
<concept_desc>Social and professional topics~History of programming languages</concept_desc>
<concept_significance>300</concept_significance>
</concept>
</ccs2012>
\end{CCSXML}

\ccsdesc[500]{Software and its engineering~General programming languages}
%% End of generated code


%% Keywords
%% comma separated list
%%%%%%%%%%%%%%%%%%%%%\keywords{keyword1, keyword2, keyword3}  %% \keywords are mandatory in final camera-ready submission



%% Note: \maketitle command must come after title commands, author
%% commands, abstract environment, Computing Classification System
%% environment and commands, and keywords command.




\maketitle 

\subsection* {12 February 2024}

 We had a great meeting today, where Julian took us through  the Coq model and its current state. In particular, after Susan left, we also discussed how Julian designed in the Coq model how our Hoare logic builds on top of the underlying Hoare logic. This goes beyond what is in the paper.
 
We propose to meet again this week again on Thursday (or Friday), and
1) continue today’s discussion of the Hoare Logic
2) Discuss the external call Hoare rule and in particular the difference between Lift and Preserve
3) Do we need to keep the concept of “Arising”? Do we need to have one-state invariants?
 
 
If you cannot make Thursday, then we can also meet on Friday – same time. Please let me know.
 
\subsubsection*{Some notes on Coq}
\begin{enumerate}
\item
THANK you Julian for all this work, and for explaining patiently!
\item
Assertions
\begin{enumerate}
\item
Included all the usual stuff, include protection
\item
Care taken not to have recursion in negative positions 
\end{enumerate}
\item
Operational semantics
\begin{enumerate}
\item
same as in the OOPSLA paper, but is flexible - expressions, statements read and write to fields but with module restrictions; no types on variables; 
\item
Classes are stored in the locations in the heap
\item
Fields have types
Variables have no types
\item
We only care about types in the assertion level; do we need that arguments or locals have types? Yes the oper semantics checks the types of the arguments (SD ???)
\end{enumerate}
\item
Modules
\begin{enumerate}
\item
now have an “lspec” component – their Chainmail spec.
\end{enumerate}
\item
Hoare Logic
\begin{enumerate}
\item 
Assumed an underlying Hoare logic which can argue about “protection – free” assertions
\item
QUESTION FOR FUTURE: could we be parametric with what projection-free assertions are? EG allow separation logic there?
\item
Extended the underlying Hoare logic with rules about protection, calls, external calls
\item
TODO: add a conjunction rule, improve the external and internal call rule
\item
TODO: define lift/lower/preserve
\end{enumerate}
\item
Soundness of Hoare Logic
\begin{enumerate}
\item 
Defined a large-step semantics rule QUESTION: do we do the same for the paper?
\end{enumerate}
\end{enumerate}

\subsection* {15th February 2024}

Another great meeting! Julian, Susan and Sophia present. Caspian had a cold, and woke up, but he promptly went back to sleep, and we resumed the meeting.

\begin{enumerate}
\item
Susan remarked that is quite annoying that pushing frames is a relation and not a function. This is so, because the frames map variables to values, and we do not know the names of these variables. 

TO THINK: could we name the formal parameters consecutively, eg $p_1$, ... $p_n$?
\item
Julian noticed that the rules $Call1$ and $Call2$ need to also require that $x,x' \neq u$

TODO Sophia to repair the rules
\item
Coq and  Hoare Logic
\begin{enumerate}
\item
The underlying Hoare logic: Do we allow it to make judgements about external call? (yes) Do we require that it can only make judgements about protection-free assertions" (Currently the Coq encoding requires that, but if it turns out that we do not need that requirement, then we will remove it)
\item 
The rules for sequences, consequence, combination, and many rules for protection are now in Coq. Julian explained them to us. 

TODO: Julian to update the corresponding rules for protection in the document.
\item
How do we express soundness of the Hoare Logic? In Coq, the definition of soundness also "looks"  at the remaining continuation, while the document does not - but look at what the document says about sequences.
\item
How will we prove external calls? Julian will continue on the Coq avenue, and we will discuss strategy again soon. 
\end{enumerate}
\item
Julian found that $ExtCall1$ is not sound! Counterexample $a.pwd$ is protected, but we passed $a.passwd$ as an argument to the external call. 

Julian also found that $ExtCall2$/$ExtCall1$ together are too weak: Assume that $x$ was protected from $U$, and that $\overline y, z \subset U$. Then, after the external call, and provided that the module preserves protection, we know that  $x$ is protected from $U$, but with the current $ExtCall2$ we only get that $x$ is protected from $\overline y,z$. 

So, by pushing and popping we lose information. We need to revisit the idea of "preserving"

TODO: all of us to rethink the external calls rules
\end{enumerate}

\subsubsection*{Next Meeting}  on the 22nd February. We will either discuss the three papers proposed by James, or revisit the issues around the Hoare rules for external calls and the proof of soundness. We will decide which way we want to go around the middle of the week.


\subsection* {22nd February 2024}
\begin{enumerate}
\item
We discussed the current document, esp sections 5.7-5.9
\item
Julian noticed that we can probably remove the requirement $x\neq\overline{y}$ from the rules for push. TODO check
\item
We discussed refactoring the rules for calls. SD did this
\item
We discussed how we can express the two-state invariants in Dafny (example 5.9.3), James said that Dafny has labels that would help us with that. TODO: James to check whether this works in Dafny
\item 
Private Methods: Sophia said that we probably can deal with private methods with the current technology. TODO: Sophia to write an example
\item
How do we express soundness of the Hoare Logic? In Coq, the definition of soundness also "looks"  at the remaining continuation, while the document does not - but look at what the document says about sequences.
 \end{enumerate}
 
 \subsubsection*{Next Meeting}  on the 28th February -- Wednesday. James will send us one paper to read -- by Monday. 
 James will not make it between 1.-3 and 14.03.
 
 \subsection*{Message on 2nd MArch}
 
  
Split it into the underlying language section and the derived concepts section. The derived concepts are bounded execution, push/pop. And reachable objects
Removed from notation the bits we do not use; and added bits that are useful
Added explicit descrption about private fields and public methods 
Made the context of execution a set of modules — we only need one internal module, and can have any number of externals — it simplifies notation
Turned the push-operator to a set.
Duplicated the Fig. 1 (execution) so as to distinguish the original and the bounded version
Improved motivations for concepts
Introduced the idea of how many push/pop operations Arte allowed in bounded execution
Wrote a lemma about the push-operator
Wrote explanations about the lemmas

\subsection*{4h March}

Tidied up the assertions.tex file

- Introduced a new extended expression, true. Unless true is an address? ???
- Removed from syntax of assertions those that can be encoded. This Def. 3.3 is more succinct 
- Section 3.3 tried to motivate prt-frm better 
- Lines 262-265 extra explanations 
- Section 3.4 better explanations for the role of push in assertions 
- New symbol for push in assertions, which expresses that it is like an adjoin operator
- Tidied up def of push-adjoin in Fig. 6
- Lemma 3.6 changed
- Added Lemma 3.7, and wondering whether there is a part (3) to it that describes what happens when e does not terminate



\subsection*{10th May}

\begin{enumerate}
\item
Susan: does the OCAP lit use "capability as guard"? If not then stress that we do, and why we do that. If they are not explicit, can we say that making this explicit lead us to formulate that in our specs?"
\item
Susan: Shall we unify "guard effect" and "protected from object", eg "o guards effect E", and "o guarded from o" and "o guarded"
\item
Julian: \\
a) remove "intl" in the formalism; \\
b) make the defs more iterative than enumerative;\\
c) introduce the concept of state scoping other states
\item
James: a remote TODO wuld be to enhance Dafny to support quadruples
\item
James: we are not in the OCAP world, because we have packages, and public/private. 
\item
James: ways that the OCAP lit is talking about capabilities: - Authority is limited in terms of rhetoric references he comes to hold;  Attenuating authority; Mark’s thesis Access abstraction mechanism and patterns; Behavioural bounds in eventual authority
\item
James: TODO Compare the inv part of put tuples to the guarantee part in: Hayes, I.J., Jones, C.B. (2018). A Guide to Rely/Guarantee Thinking. In: Bowen, J., Liu, Z., Zhang, Z. (eds) Engineering Trustworthy Software Systems. SETSS 2017. Lecture Notes in Computer Science(), vol 11174. Springer, Cham. \texttt{https://doi.org/10.1007/978-3-030-02928-9\_1}
\end{enumerate}

\section{TODOs before sharing our document}

Annotated by LARGE, when more work needed, and HUGE, when even more work needed.
 And \st{strike through} those that were done.
 
\subsection{TODOs before sharing with superficial reader}

 
\begin{enumerate}
\item
Complete the approach section
\end{enumerate}
 
 \subsection{Must before sharing with a specialist reader}
 These must have been done.  
 
\begin{enumerate}
\item
\st{In approach, explain how we deal with external calls in the  example.}
\item
\st{Settle on the definition of  the triangle for states (currently in section 4.3), and make sure that the related lemmas hold.}
\item
explain that $s_0\txteq s;\_$ is short for $s_0\txteq s$  or  $s_0\txteq s;s'$ for some $s'$. AH. perhaps add a relation $s \sqsubset s'$ for this? And similar for specs?
\item
Add the auxiliary lemma from the questions document
\item
Unify the macros for external and internal

\item
Clarify that sometimes we rely on implicit renaming of variables — say when

\item
Explain that local variables may be assigned to, but formal parameters will not. Write the corresponding lemma -- or axiom?
On the other hand, if we do prove what is needed in 1.4.1, we may not need to do any if that.

\item
\st{Check whether we need weaker/stronger specification (section 7.2)} I have removed it. We do not need in the work presented, but it is good to have.

\item
\st{Check whether we need ExtCall\_WithSpec\_Weak. Remove the unnecessary external call rules — but check that they are indeed unnecessary}

\item
\st{Check Julian's question about potential circularity in $\_\ll\_$. And repair the typos he found}
\item
\st{introduce the scoping relation for pairs of states, and make definitions more recursive.}

\item
\textbf{LARGE:} Revisit section 8

\item
Remove all internal discussions; remove colours from the rest

\item

\textbf{LARGE}: Do we need numbers and booleans values in the oper semantics, 
Do we need them in the syntax of predicates assertions and for predicate execution from appendix?
Do we define $==$ for numbers and booleans to?  
Do we need to add conditionals in the oper. semantics and in the Hoare triples. What to do if needed?
\item

replace the $\leadsto$ arrow in Fig 1, Fig. 6 by $\rightarrow$, to match the one from the formal definition. In Fig. 12, if poss. replace the double arrow by a $\leadsto_{fin}$ arrow 

\item
add to oper semantics rules conditions so as to avoid call across modules and same for field read or write. Also add the information as to whether the currently executing  method is \prg{punblic} -- this is annoying but is needed for proofs. Say that this is ghost state for us.

\item
check with Julian the notation for selecting parts of the state eg $\phi_1.(\prg{local\_map})$

\item
Add that Spec is part of a module

\item
IMPORTANT: Add that assertions in the module invariants are encapsulated, and that protected may not appear in negative positions.

\item
   define $\externalexec$ and also delete the globally reachable story. Q: do we delete the Arising story too? 

\end{enumerate}

 \subsection{Goof to have before sharing with a specialist reader}

\begin{enumerate}
\item
revisit terminology --as per email from 10th May.
\item
Add the examples from the questions document -- add to appendix. And perhaps remove some to the examples from main document.

\item
use the example environment more often?

\item
make the NOTEs more succinct

\item
Show/Say where in our current example we are using which salient proof rules

\item
Give a high level description of the main challenges and ideas in the proof of soundness. Gove a high level characterisation of $\_\ll\_$.

\item
Push some of the proofs in the appendix.

\item
Motivate more the purpose of some definitions.

\item
Encaps makes less sense now that all fields are private. 

\end{enumerate}


 \subsection{Must before POPL}

These are all \textbf{Large}.

\begin{enumerate}
\item
\st{solve the problem with stonger version of method call -- email from 9th May.}

\item
motivate "capabilities as guards" and then use to motivate "protected"
\item
introduction
\item
related work
\item
flesh out proofs
\item
reflect on limitations to applicability: eg determinism, no assignment to formal parameters, 
\item
flesh out the proof of our example
\item
write the specifications of the other case studies using our approach
\item
\st{improve the def. of bounded execution so that it is more easily understood.} more or less done?
\item
change colours in the diagrams; 
\item
improve the latex niggles 
\item
add the complete definitions in the appendix. Esp. the oper semantics
\item
Write out the full spec for our modules. Esp. for their methods.
\item
Constructors?

\item
Explain that some specs follow from others -- and add the sub-sepc rules

\item 
\textbf{Julian}: revisit the claim that our assertions are classical

\item
POSSIBLE; reorganize approach, so that we start with \prg{Shop}, and then show the modules.
\end{enumerate}
 
\end{document}
