\vspace{1cm} Finally, we discuss the proof


\newcommand{\SP}{$\strut \ \ \ \ $}

\beginProof{l:no:meth:calls}
By induction on the rules in Fig. \ref{f:underly}.

\completeProof 

\subsection{Adaptation}
\label{appendix:adaptation}
 
 
 We now discuss the proof of Lemma \ref{lemma:push:ass:state}.

 \vspace{0.5cm}
 
 \beginProofSub{lemma:push:ass:state}{l:push:stbl}
$~$ \\
To Show: \ \ \  $\Stable{\,  \PushASLong {(y_0,\overline y)} A\, }$
\\
By structural induction on $A$.\\
\completeProofSub

\vspace{1cm}

\beginProofSub{lemma:push:ass:state}{lemma:push:ass:state:one}
$~$ \\
To Show: \ \ \  $(*)\ \ \ M, \sigma \models \PushASLong  {Rng(\phi)} {A}\  \ \ \ \ \  \ \ \    \Longrightarrow  \ \ \ \ M,  \PushSLong {\phi} {\sigma}   \models A$
\\ 
\SP \\
We first prove the property that for all $\alpha$,   $\overline {\phi_1}$, $\overline {\phi_2}$, $\phi$ and $\chi$\\
$\strut ~ \ \ \ \ \ (**)\ \ \    M, (\overline \phi_1,\chi) \models \protectedFrom \alpha {Rng(\phi)} \ \Longrightarrow \ M, (\overline \phi_2\cdot \phi,\chi) \models \inside \alpha$
\\
We define $\sigma_1 \triangleq (\overline {\phi_1},\chi)$, and  $\sigma_2 \triangleq (\overline {\phi_2}\cdot \phi,\chi) $.\\
The above definitions imply that: \\
\SP (1)\ \ $\forall \alpha',\forall \overline f.[\  \interpret {\sigma_1} {\alpha'.\overline f} =  \interpret {\sigma_2} {\alpha'.\overline f}\ ]$\\
\SP (2)\ \ $\forall \alpha'.[\  \Relevant {\alpha'} {\sigma_1} = \Relevant {\alpha'} {\sigma_2}\ ]$\\
\SP (3)\ \ $\LRelevantO {\sigma_2} = \bigcup_{\alpha'\in Rng(\phi)} \Relevant {\alpha'} {\sigma_2} $.\\
% $\strut ~ \ $\\
We now assume that\\
\SP (4)\ \ $M, \sigma_1 \models \protectedFrom \alpha {Rng(\phi)}$.\\
and want to show that\\
\SP (??)\ \ $M, \sigma_2 \models \inside \alpha$\\
From (4) and  by definitions, we obtain that\\
\SP (5)\ \ $\forall \alpha'\in Rng(\phi).\forall \alpha''\in \Relevant {\alpha'} {\sigma_1}.\forall f.[ \   M, \sigma_1 \models \alpha'':\prg{extl}\ \rightarrow \alpha''.f  \neq \alpha\ ]$, \ \ \ \ and also\\
\SP (6)\ \ $\alpha \notin Rng(\phi)$\\
From (5) and (3) we obtain:\\
\SP (7)\ \  $\forall \alpha' \in \LRelevantO {\sigma_2}.\forall f.[ \   M, \sigma_1 \models \alpha':\prg{extl}\ \rightarrow \alpha'.f  \neq \alpha\ ]$\\
From (7) and (1) and (2) we obtain:\\
\SP (8) \ \  $\forall \alpha' \in \LRelevantO {\sigma_2}.\forall f.[ \   M, \sigma_2 \models \alpha':\prg{extl}\ \rightarrow \alpha'.f  \neq \alpha\ ]$\\
From (8), by definitions, we obtain\\
 \SP (10)\ \ $M, \sigma_2 \models \inside \alpha$\\
 This completes the proof of (**).
 $\strut ~ \ $\\
 To prove (*), we apply induction on the structure of $A$. Ffor the case where $A$ has the form $\inside {\alpha.\overline f}$, we use (**) taking $\overline {\phi_1} = \overline { \phi_2}$, and $\sigma \triangleq (\overline {\phi_1},\chi).$
\\
\completeProofSub
 

\vspace{1cm}

\beginProofSub{lemma:push:ass:state}{lemma:push:ass:state:two}
$~$ \\
To Show \ \ \  $(*)\ \ \  M,  \PushSLong {\phi} {\sigma}   \models  A  \wedge \extThis    \ \  \ \  \Longrightarrow  \ \ \ \ M, \sigma \models \PushASLong  {Rng(\phi)} {A}$ 
\\ 
\SP \\
We first prove the property that for all $\alpha$,   $\overline {\phi_1}$, $\overline {\phi_2}$, $\phi$ and $\chi$\\
$\strut ~ \ \ \ \ \ (**)\ \ \    M, (\overline {\phi_1}\cdot\phi,\chi) \models \inside \alpha   \wedge \extThis \ \ \Longrightarrow \ \ M, (\overline {\phi_2},\chi) \models \protectedFrom \alpha {Rng(\phi)} $
\\
We define $\sigma_1 \triangleq (\overline {\phi_1}\cdot \phi,\chi)$, and  $\sigma_2 \triangleq (\overline {\phi_2},\chi) $.\\
The above definitions imply that: \\
\SP (1)\ \ $\forall \alpha',\forall \overline f.[\  \interpret {\sigma_1} {\alpha'.\overline f} =  \interpret {\sigma_2} {\alpha'.\overline f}\ ]$\\
\SP (2)\ \ $\forall \alpha'.[\  \Relevant {\alpha'} {\sigma_1} = \Relevant {\alpha'} {\sigma_2}\ ]$\\
\SP (3)\ \ $\LRelevantO {\sigma_1} = \bigcup_{\alpha'\in Rng(\phi)} \Relevant {\alpha'} {\sigma_1}$.\\
We   assume that\\
\SP (4)\ \  $M, \sigma_1 \models \inside \alpha \wedge \extThis$.\\
and want to show that\\
\SP (??)\ \ $M, \sigma_2 \models \PushASLong  {Rng(\phi)} {A}$.\\
From (4), and unfolding the definitions, we obtain:\\
\SP (5)\ \  $\forall \alpha'\in \LRelevantO {\sigma_1}.\forall f.[ \   M, \sigma_1 \models \alpha':\prg{extl}\ \rightarrow \alpha'.f  \neq \alpha\ ]$, \ \ \ and\\
\SP (6)\ \ $\forall \alpha'\in Rng (\phi). [ \ \alpha'\neq \alpha \ ]$.\\
....\\
\SP (8)\ \  $\forall \alpha'\in Rng (\phi).[ \alpha\neq \alpha' \wedge \forall \alpha''\in \Relevant {\alpha'} {\sigma_2}.\forall f.[\ M, \sigma_2 \models \alpha'':\prg{extl} \rightarrow \alpha''.f \neq \alpha\ ]$
\\
From (8) and definitions, we obtain\\
\SP (9)\ \  $\forall \alpha'\in Rng (\phi).[\ M, \sigma_2 \models \alpha \protectedFrom \alpha {\alpha'}\ ]$.\\
This completes the proof of (**).
 $\strut ~ \ $\\
 To prove (*), we apply induction on the structure of $A$, and use (*) taking   $\overline {\phi_1} = \overline { \phi_2}$, and $\sigma \triangleq (\overline {\phi_1},\chi).$

\completeProofSub

\vspace{1cm}
\beginProofSub{lemma:push:ass:state}{lemma:push:ass:state:three}
$~$ \\
To Show:\ \ \    $M, \sigma  \models  A  \wedge \extThis  \ \wedge \ M\cdot\Mtwo \models \PushSLong {\phi} {\sigma}   \ \  \ \ \  \  \Longrightarrow  \ \ \ \ M, \PushSLong {\phi} {\sigma} \models \PushASLong  {Rng(\phi)} {A}$
\\ 
....
\completeProofSub