\newcommand{\SPSF}{\SPS \ \ \ \ \ \ \ }
\newcommand{\Apr}{A_{pr}}

\subsection{Proof of Theorem \ref{t:quadruple:sound} -- part (A) }
\label{s:app:proof:sketch;quadruples}
\noindent
\vspace{.2cm}
  {\textbf{Begin Proof}} 


\noindent
Take any $M$, $\Mtwo$, with\\ 
$\strut \ \ \hspace{2.3cm} \ \ (1) \ \ \vdash M $.
\\
We will prove that\\
$\strut \ \ \hspace{2.3cm} \ \ (*)\ \ \forall \sigma, A, A', A''.$\\
$\strut \ \ \hspace{2.3cm} \ \ \ \ \  \ \ [ \ M\ \vdash\  \quadruple {A} {\sigma.\prg{cont}} {A'} {A''}  \ \ \Longrightarrow \ \    M\ \modelsD\  \quadruple {A} {stmt} {A'} {A''}\ ]$.\\
by induction on the well-founded ordering  $\_ \ll_{M,\Mtwo}  \_$.
\\
Take $\sigma$, $A$, $A'$, $A''$, $\overline z$, $\overline w$, $\overline \alpha$, $\sigma'$, $\sigma''$  arbitrary. Assume that\\
$\strut \ \ \hspace{2.3cm} \ \ (2) \ \ M\ \vdash\  \quadruple {A} {\sigma.\prg{cont}} {A'} {A''}$\\
$\strut \ \ \hspace{2.3cm} \ \ (3) \ \ \overline {w}=\fv(A)\cap dom(\sigma), \  \ \ \  \overline z = {\fv(A)\setminus dom(\sigma)}$\footnote{Remember that $dom(\sigma)$ is the set of variables defined in the top frame of $\sigma$} \\
%\setminus( \vs({\sigma.\prg{cont}}) \cup dom(\sigma) \} )}$ \\ %\setminus \vs(\sigma.\prg{cont} ) = \overline z$\\
$\strut \ \ \hspace{2.3cm} \ \ (4) \ \ \satDAssertFrom M  \sigma k   {A{[{\overline { \alpha/z}]}}}$\\
To show\\
$\strut \ \ \hspace{2.3cm} \ \ (**)\ \ \  \ \    \leadstoBoundedStarFin {\Mtwo\cdot M}  {\sigma}  {\sigma'}\ \ \Longrightarrow\ \     \satDAssertFrom M  {\sigma'} k   {{A'}{[{\overline {\alpha/z}]}}}$\\
$\strut \ \ \hspace{2.3cm} \ \ (*\!*\!*) \ \ \,    \leadstoBoundedStar  {\Mtwo\cdot M}  {\sigma}  {\sigma''}\ \, \ \ \Longrightarrow\ \     \satDAssertFrom M  {\sigma''}  k  \extThis \rightarrow {{A''[{\overline {\alpha/z}}][\overline{\interpret \sigma {w}/w}]}}$
 
 \vspace{.2cm}
\noindent
We proceed by case analysis on the  rule applied in the last step of the proof of (2). We only describe some cases.

\begin{description} 
 
 \item[{\sc{mid}}] 
 
 By Theorem \ref{l:triples:sound}.

\newcommand{\SPS}{\strut \ \ \hspace{0.5cm} \ \ }
 
\item[{\sc{sequ}}] 
Therefore, there exist statements $stmt_1$ and $stmt_2$, and assertions  $A_1$, $A_2$ and $A''$, so that $A_1\txteq A$, and $A_2 \txteq A'$, and $\sigma.\prg{cont}\txteq  stmt_1; stmt_2$,.
We apply lemma \ref{lemma:subexp}, and obtain that there exists an intermediate state $\sigma_1$. 
The proofs for  $stmt_1$ and $stmt_2$, and the intermediate state $\sigma_1$ are in the $\ll$ relation. 
Therefore, we can apply the inductive hypothesis.
 
  \item[{\sc{combine}}]  by induction hypothesis, and unfolding and folding the definitions
  
 \item[{\sc{consequ}}]  using Lemma \ref{l:shallow:scoped} part \ref{fourSD}  and axiom \ref{lemma:axiom:enc:assert:ul}

 
\renewcommand{\Apr}{A_{pr}}
\newcommand{\Apra}{A_{pra}}
\newcommand{\Apoa}{A_{poa}}
\item[{\sc{Call\_Int}}]
 
 Therefore, there exist $u$, $y_o$, $C$, $\overline y$,  $A_{pre}$, $A_{post}$, and $A_{mid}$, such that \\
 $\SPS (5) \ \ \sigma.\prg{cont}\txteq u:=y_0.m(\overline y)$,\\
% $\SPS (5a) \ \ \{ u, y_0, ... y_n \}  \subseteq \overline w $, \ \ $\overline z \cap  \{ u, y_0, ... y_n \}  = \emptyset$ \\ 
$\SPS (6) \  \ \promises  M {\mprepostN {A_{pre}}{D}{m}{x}{D}{A_{post}} {A_{mid}}}$, \\
$\SPS (7) \  \ A \txteq y_0:D ,\overline {y:D}\ \wedge \  A_{pre}[y_0,\overline y/\prg{this},\overline x],$\\
$\SPSF  A'  \txteq A_{post}[y_0,\overline y, u/\prg{this},\overline x, \prg{res}],$\\ 
$\SPSF  A'' \txteq  A_{mid}$. 
\\
Also, \\
$\SPS (8) \ \ \leadstoBounded  {\Mtwo\cdot M}  {\sigma}  {\sigma_1}$, \\
 where \\
$\SPS (8a) \ \ \ \sigma_1\triangleq (\PushSLong { (\prg{this}\mapsto {\interpret{\sigma} {y_0}},{\overline{x \mapsto {\interpret{\sigma} {y}}}})}\sigma [\prg{cont}\mapsto stmt_m]$, \\ 
$\SPS (8b) \ \ \   \prg{mBody}(m,D,M)=\overline{y:D}\{\    stmt_m\ \}$ .\\
We define the shorthands:\\
$\SPS (9) \ \  \Apr \triangleq  \prg{this}:D,\overline{x:D}\, \wedge\, A_{pre}$.
\\
$\SPS (9a) \ \  \Apra \triangleq  \prg{this}:D,\overline{x:D}\, \wedge\, A_{pre}\, \wedge\, {\PushASLong  {(y_0,\overline {y})}  {A_{pre}} } $.
\\
$\SPS (9b) \ \  \Apoa \triangleq  A_{post}\, \wedge\, {\PushASLong {\prg{res}}  {A_{post}}} $.
\\
By (1), (6), (7), (9),  and definition of $\vdash M$ in Section \ref{sect:wf}  rule {\sc{Method}} and we obtain\\
$\SPS (10) \ \  M \vdash  \quadruple { \ \Apra \  } {\ stmt_m } {\ \Apoa\ } {A_{mid}}$.\\
From (8) we obtain\\  
$\SPS (11) \ \ (\Apra,\sigma_1,\Apoa, A_{mid}) \ll_{M,\Mtwo} (A,\sigma,A', A'')$
\\
In order to be able to apply the induction hypothesis, we need to prove something of the form $... \sigma_1 \models \Apr[../fv(\Apr)\setminus dom(\sigma_1)]$. To that aim we will apply Lemma   \ref{l:calls} part \ref{l:calls:callee:one} on (4), (8a) and (9). For this, we take
\\
$\SPS (12) \ \ \ \overline {v_1} \triangleq \prg{this},\overline x$, \ \ \ 
$\overline {v_2} \triangleq  \fv(\Apr)\setminus \overline {v_1}$, \ \ \ 
$\overline {v_3} \triangleq  y_0,\overline y$,\ \ \ 
$\overline {v_4} \triangleq  \fv(A)\setminus \overline {v_3}$
%,\overline {v_2})$.
% \ $\overline {\alpha_2} \triangleq  \overline \alpha$,\ \ $\overline {v_6} \triangleq  y_0 $, \ \  $\overline {v_4} \triangleq  \fv(A)\setminus \{  \overline {v_1},  \overline {v_6}, \overline z \}$,  
\\
These definitions give that
\\
$\SPS (12a) \ \  A \txteq \Apr[\overline {v_3/v_1}]$,
\\
$\SPS (12b)  \ \  \fv(\Apr)\ =\overline{v_1}; \overline {v_2}$.
\\ 
$\SPS (12c)  \ \  \fv(A)\ =\overline {v_3};\overline {v_4} $.
\\
%The disjointness precondition of {\sc{Call\_Int}} gives that\\
%$\SPS (12d)  \ \  \overline {v_3}\, \#\, \overline {v_1}, \overline {v_5}$.
%\\
With (12a), (12b), (12c), (  and Lemma \ref{l:sfs}  part (\ref{l:sfs:five}), we obtain that \\ 
$\SPS (12d)\ \    \overline {v_2} =   \overline{y_r}; \overline{v_4}$, \ \ \ \ where $\overline{y_r}\triangleq {\overline {v_2}}\cap  \overline {v_3}$
\\
Furthermore, (8a), and (12) give that:\\
$\SPS (12e) \ \  \overline { {\interpret {\sigma_1} {v_1}} = {\interpret {\sigma} {v_3}} }$
\\
%Moreover,   $y_0,\overline y \subseteq dom(\sigma)$, and with (3), we obtain that $\overline z \subseteq \overline {v_4}$. We define\\
%$\SPS (12f) \ \ \overline {v_5} \triangleq  \overline {v_4}\setminus \overline {z}$\ \ \ \ \ \ \ which implies\ \ $ \overline {v_4} = \overline z; \overline{v_5}$
%\\
Then, (4),  (12a),   (12c) and (12f)  give that\\
$\SPS (13) \ \ \satDAssertFrom M  {\sigma} {k}   {\Apr[\overline{v_3/v_1}][\overline{\alpha/z}]}$\\
Moreover, we have that $\overline z \# \overline {v_3}$. From   Lemma \ref{l:sfs}  part (\ref{l:sfs:seven}) we obtain $\overline z \# \overline {v_1}$. 
And, because $\overline \alpha$ are addresses wile $\overline {v_1}$ are variables, we also have that $\overline \alpha\#\overline {v_1}$.
These facts, together with   Lemma \ref{l:sfs}  part (\ref{l:sfs:six}) give that\\
$\SPS (13a) \ \    \Apr[\overline{v_3/v_1}][\overline{\alpha/z}] \txteq   \Apr[\overline{\alpha/z}]  [\overline{v_3/v_1}] $\\
From (13a) and (13), we obtain
\\
$\SPS (13b) \ \     \satDAssertFrom M  {\sigma} {k}   { \Apr[\overline{\alpha/z}]  [\overline{v_3/v_1}] }$
\\
From (4), (8a), (12a)-(12e)  we see that the requirements  %\ref{l:calls:r:one}-\ref{l:calls:r:four} 
 of Lemma \ref{l:calls}  part  \ref{l:calls:callee:one} are satisfied where we take  $\Ain$ to be $\Apr[\overline{\alpha/z}]$.
 We use the definition of $y_r$ in (12d), and define\\
$\SPS (13c) \ \ \overline {v_6} \triangleq  y_r;  (\overline {v_4}\setminus \overline{z})$\ \ \ \ which, with (12d) also gives:\ $ \overline {v_2} = \overline{v_6}; \overline{z}$
\\
We apply   Lemma   \ref{l:calls} part \ref{l:calls:callee:one} on (13b), (13c)  and  obtain\\
$\SPS (14a) \ \  \satDAssertFrom M  {\sigma_1} {k}   { \Apr[\overline{\alpha/z}][ \overline {  \interpret{\sigma} {v_6}/v_6}] } $. \\
Moreover, we have the $M, \sigma_1 \models \intThis$. We apply lemma \ref{lemma:internal:adapted}, and obtain\\
$\SPS (14b) \ \  \satDAssertFrom M  {\sigma_1} {k}   
      { \Apr[\overline{\alpha/z}][ \overline {  \interpret{\sigma} {v_6}/v_6}] 
          \, \wedge\,  
          { \PushASLong {(\prg{this}, \overline y)} {\Apr}   
       } } $. \\
%       {\Apr} %{ \Apr[\overline{\alpha/z}][ \overline {  \interpret{\sigma} {v_6}/v_6}]  }    
%        } }$. \\
 With similar re-orderings to earlier, we obain\\
$\SPS (14b) \ \  \satDAssertFrom M  {\sigma_1} {k}   {\Apra[\overline{\alpha/z}][\overline{\interpret{\sigma}{v_6}/v_6}]}$. 

\vspace{.1cm}

For the proof of $(**)$ as well as for the proof of $(*\!*\!*)$, we will want to apply the inductive hypothesis.   For this, we need to determine the value of  
$\fv(\Apr)  \setminus dom(\sigma_1)$, as well as the value of $\fv(\Apr)  \cap dom(\sigma_1)$. 
  This is what we do next. From (8a) we have that\\
$\SPS (15a) \ \  dom(\sigma_1)=\{ \prg{this}, \overline x \}$.\\
This, with (12)  and (12b)  gives  that\\
$\SPS (15b) \ \ \fv(\Apra)\cap dom(\sigma_1)= \overline {v_1}$.\\
$\SPS (15c) \ \  \fv(\Apra)  \setminus dom(\sigma_1) = \overline {v_2}$. \\
Moreover, (12d) and (13d) give that\\
$\SPS (15d) \ \  \fv(\Apra)  \setminus dom(\sigma_1) = \overline{z_2} = \overline {z}; \overline{v_6}$.

%\newcommand{\Apra}{A_{o,a}}

 \vspace{.3cm}
Proving $(**)$. Assume that   $\leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma}  {\sigma'}$. Then, by the operational semantics, we obtain that 
there exists state $\sigma_1'$, such that \\
$\SPS (16) \ \ \leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma_1}  {\sigma_1'}$ \\
$\SPS (17) \ \ \sigma'=(\sigma_1'\popSymbol)[u \mapsto {\interpret {\sigma_1'} {\prg{res}}}][\prg{cont}\mapsto \epsilon]$.
\\
We now apply the induction hypothesis on (14), (16), (15d), and obtain
\\ 
$\SPS (18) \ \  \satDAssertFrom M  {\sigma_1'} {k}   {(A_{post})[\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]}$.
\\
We now want to obtain something of the form $...\sigma' \models ...A'$. We now want to be able to apply   Lemma \ref{l:calls:return},  part \ref{l:calls:caller:one} on (18). Therefore, we  define
\\
$\SPS (18a) \ \  \Aout \triangleq  \Apoa[\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]$
\\
$\SPS (18b) \ \  \overline {v_{1,a}} \triangleq  \overline {v_1}, \prg{res}$,   \ \ \ \ 
$\overline {v_{3,a}} \triangleq  \overline {v_3}, u$.
\\
The wellformedness condition for specifications requires that $\fv (A_{post}) \subseteq  \fv (\Apr) \cup \{ \prg{res} \}$. 
This, together with  (9), (12d) and (18b) give  \\
$\SPS (19a) \ \  \fv(\Aout) \subseteq  \overline {v_{1,a}}$
\\
Also, by (18b), and (17), we have that   
\\
$\SPS (19b) \ \ \overline {\interpret {\sigma'} {v_{3,a}}  =  \interpret {\sigma_1'} {v_{1,a}} }$.
\\
From (4) we obtain that  $ k \leq \DepthSt {\sigma}$. From  (8a) we obtain that $ \DepthSt {\sigma_1} = \DepthSt {\sigma} +1$. From (16) we obtain that  $ \DepthSt {\sigma_1'} = \DepthSt {\sigma_1}$, and from (17) we obtain that $ \DepthSt {\sigma'} = \DepthSt {\sigma_1'} -1$. All this gives that:\\
$\SPS (19c) \ \ k \leq \DepthSt {\sigma'}$
\\
We now apply  Lemma \ref{l:calls:return},  part \ref{l:calls:caller:one}, and obtain  
\\
$\SPS (20) \ \  \satDAssertFrom M  {\sigma'} {k}   {\Aout[\overline{v_{3,a}/v_{1,a}}]}$.
\\
We expand the definition from (18a), and re-order the substitutions by a similar argument as in in step (13a), using Lemma    part (\ref{l:sfs:six}), and obtain\\
$\SPS (20a) \ \  \satDAssertFrom M  {\sigma'} {k}   {\Apoa[\overline{v_{3,a}/v_{1,a}}][\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]}$.
\\
By  (20a),   (18b),  and because  by Lemma \ref{l:var:unaffect} we have that $\overline{\interpret {\sigma} {v_6}}$=$\overline{\interpret {\sigma'} {v_6}}$, we  obtain
\\
$\SPS (21) \ \ \satDAssertFrom M  {\sigma'} {k}   {(\Apoa)[y_0,\overline y, u/\prg{this},\overline x, \prg{res}][\overline{\alpha/z}]}. $. 
\\
With (7) we conclude.\\
~ \\



 \vspace{.3cm}
Proving $(*\!*\!*)$. Take a $\sigma''$. Assume that\\
$\SPS (15) \ \ \leadstoBoundedStar   {\Mtwo\cdot M}  {\sigma}  {\sigma''}$\\
$\SPS (16) \ \ \ {\Mtwo\cdot M}, \sigma'' \models \extThis$.\\
Then, from (8) and (15) we also obtain that\\
$\SPS (15) \ \ \leadstoBoundedStar   {\Mtwo\cdot M}  {\sigma_1}  {\sigma''}$\\
By (10), (11) and application of the induction hypothesis on (13),  (14c), and (15), we obtain that\\
$\SPS (\beta') \ \  \satDAssertFrom M  {\sigma''} {k}   {A_{mid}[\overline{\alpha/z}][\overline{\interpret \sigma {w}/w}]}$.\\
and using (7) we are done.
\\
~ \\



%\item[{\sc{Call\_Int\_Adapt}}] is similar to {\sc{Call\_Int}}. 
%We highlight the differences in \npgreen{green}.
%Therefore, there exist $u$, $y_o$, $C$, $\overline y$,  $A_{pre}$, $A_{post}$, and $A_{mid}$, such that \\
% $\SPS (5) \ \ \sigma.\prg{cont}\txteq u:=y_0.m(\overline y)$,\\
%% $\SPS (5a) \ \ \{ u, y_0, ... y_n \}  \subseteq \overline w $, \ \ $\overline z \cap  \{ u, y_0, ... y_n \}  = \emptyset$ \\ 
%$\SPS (6) \  \ \promises  M {\mprepostN {A_{pre}}{D}{m}{x}{D}{A_{post}} {A_{mid}}}$, \\
%$\SPS (7) \  \ A \txteq y_0:D ,\overline {y:D}\ \wedge \  \PushASLongG {({y_0, \overline y})} {(A_{pre} [y_0/\prg{this}])},$ \\
%$\SPS \ \ \ \  A'  \txteq \PushASLongG  {({y_0, \overline y})} {(A_{post}[y_0/\prg{this},u/res])},$\\
%$\SPS\ \ \ \   A'' \txteq  A_{mid}$. 
%\\
%Also, \\
%$\SPS (8) \ \ \leadstoBounded  {\Mtwo\cdot M}  {\sigma}  {\sigma_1}$, \\
% where \\
%$\SPS (8a) \ \ \ \sigma_1\triangleq (\PushSLong { (\prg{this}\mapsto {\interpret{\sigma} {y_0}},{\overline{x \mapsto {\interpret{\sigma} {y}}}})}\sigma [\prg{cont}\mapsto stmt_m]$, \\ 
%$\SPS (8b) \ \ \   \prg{mBody}(m,D,M)=\overline{y:D}\{\    stmt_m\ \}$ .\\
%We define the shorthand:\\
%$\SPS (9) \ \  \Apr \triangleq  \prg{this}:D,\overline{x:D}\, \wedge\, A_{pre}$.
%\\
%$\SPS (9a) \ \  \Apra \triangleq  \prg{this}:D,\overline{x:D}\, \wedge\, A_{pre}\, \wedge\, {\PushASLong  {(y_0,\overline {y})}  {A_{pre}} } $.
%\\
%$\SPS (9b) \ \  \Apoa \triangleq  A_{post}\, \wedge\, {\PushASLong {\prg{res}}  {A_{post}}} $.
%\\
%
%By (1), (6), (7), (9), and definition of $\vdash M$ in Section \ref{sect:wf}, we obtain\\
%$\SPS (10) \ \  M \vdash  \quadruple { \ \Apra \  } {\ stmt_m } {\ \Apoa \ } {A_{mid}}$.\\
%From (8) we obtain\\  
%$\SPS (11) \ \ (\Apra,\sigma_1,\Apoa, A_{mid}) \ll_{M,\Mtwo} (A,\sigma,A', A'')$
%\\
%In order to be able to apply the induction hypothesis, we need to prove something of the form $... \sigma_1 \models \Apr[../fv(\Apr)\setminus dom(\sigma_1)]$. To that aim we will apply \npgreen{Lemma   \ref{l:calls} part \ref{l:calls:callee:two}} on (4), (8a) and (9). For this, we take
%\\
%$\SPS (12) \ \ \ \overline {v_1} \triangleq \prg{this},\overline x$, \ \ \ 
%$\overline {v_2} \triangleq  \fv(\Apr)\setminus \overline {v_1}$, \ \ \ 
%$\overline {v_3} \triangleq  y_0,\overline y$,\ \ \ 
%$\overline {v_4} \triangleq  \fv(A)\setminus \overline {v_3}$\\
%These definitions give that
%\\
%$\SPS (12a) \ \  A \txteq  \PushASLongG {({\overline {v_3}})} {(\Apr[\overline {v_3/v_1}])}$,
%\\
%$\SPS (12b)  \ \  \fv(\Apr)\ =\overline{v_1}; \overline {v_2}$.
%\\ 
%$\SPS (12c)  \ \  \fv(A)\ =\overline {v_3};\overline {v_4} $.
%\\
%%The disjointness precondition of {\sc{Call\_Int}} gives that\\
%%$\SPS (12d)  \ \  \overline {v_3}\, \#\, \overline {v_1}, \overline {v_5}$.
%%\\
%With (12a), (12b), (12c),and Lemma \ref{l:sfs}  part (\ref{l:sfs:five}), we obtain that \\ 
%$\SPS (12d)\ \    \overline {v_2} =   \overline{y_r}; \overline{v_4}$, \ \ \ \ where $\overline{y_r}\triangleq {\overline {v_2}}\cap  \overline {v_3}$
%\\
%Furthermore, (8a), and (12) give that:\\
%$\SPS (12e) \ \  \overline { {\interpret {\sigma_1} {v_1}} = {\interpret {\sigma} {v_3}} }$
%\\
%%Moreover,   $y_0,\overline y \subseteq dom(\sigma)$, and with (3), we obtain that $\overline z \subseteq \overline {v_4}$. We define\\
%%$\SPS (12f) \ \ \overline {v_5} \triangleq  \overline {v_4}\setminus \overline {z}$\ \ \ \ \ \ \ which implies\ \ $ \overline {v_4} = \overline z; \overline{v_5}$
%%\\
%Then, (4),  (12a)  give that\\
%$\SPS (13) \ \ \satDAssertFrom M  {\sigma} {k}   {\PushASLongG {({\overline {v_3}})} {\Apr[\overline {v_3/v_1}]}}$\\
%Moreover, we have that $\overline z \# \overline {v_3}$. From   Lemma \ref{l:sfs}  part (\ref{l:sfs:seven}) we obtain $\overline z \# \overline {v_1}$. 
%And, because $\overline \alpha$ are addresses wile $\overline {v_1}$ are variables, we also have that $\overline \alpha\#\overline {v_1}$.
%These facts, together with   Lemma \ref{l:sfs}  part (\ref{l:sfs:six}) give that\\
%$\SPS (13a) \ \    {\Apr[\overline{v_3/v_1}][\overline{\alpha/z}]}  \txteq     {\Apr[\overline{\alpha/z}]  [\overline{v_3/v_1}] }$\\
%From (13a) and (13), we obtain
%\\
%$\SPS (13b) \ \     \satDAssertFrom M  {\sigma} {k}    {\PushASLongG {({\overline {v_3}})} {( \Apr[\overline{\alpha/z}]  [\overline{v_3/v_1}] )}}$
%\\
%From (4), (8a), (12a)-(12e)  we see that the requirements  %\ref{l:calls:r:one}-\ref{l:calls:r:four} 
% of Lemma \ref{l:calls}  %part  \ref{l:calls:callee:two} are satisfied 
% where we take  $\Ain$ to be $\Apr[\overline{\alpha/z}] $.
%  We use the definition of $y_r$ in (12d), and define\\
%$\SPS (13c) \ \ \overline {v_6} \triangleq  y_r;  (\overline {v_4}\setminus \overline{z})$, \ \ \ this also gives that $\overline {v_2}=\overline{v_6}; \overline z$
%\\
%We apply   Lemma   \ref{l:calls} part \ref{l:calls:callee:two} on (13b), (13c)  and  obtain\\
%\npgreen{$\SPS (14) \ \   M,  {\sigma_1}  \models  {\Apr[\overline{\alpha/z}][\overline{\interpret{\sigma}{v_6}/v_6] }}$}. \\
%\npgreen{ which is equivalent to} \\
%$\SPS (14aa) \ \  \satDAssertFrom M  {\sigma_1} {\npgreen{\DepthSt {\sigma_1} }}  {\Apr[\overline{\alpha/z}][\overline{ {\interpret{\sigma}{v_6}}/ v_6} ]} $. \\
%By similar argument as in the previous case, we deduce that\\
%$\SPS (14a) \ \  \satDAssertFrom M  {\sigma_1} {\npgreen{\DepthSt {\sigma_1} }}  {\Apra[\overline{\alpha/z}][\overline{ {\interpret{\sigma}{v_6}}/ v_6} ]} $.
%~ \\
%For the proof of $(**)$ as well as for the proof of $(*\!*\!*)$, we will want to apply the inductive hypothesis.   For this, we need to determine the value of  
%$\fv(\Apr)  \setminus dom(\sigma_1)$, as well as the value of $\fv(\Apr)  \cap dom(\sigma_1)$. 
%  This is what we do next. From (8a) we have that\\
%$\SPS (15a) \ \  dom(\sigma_1)=\{ \prg{this}, \overline x \}$.\\
%This, with (12)  and (12b)  gives  that\\
%$\SPS (15b) \ \ \fv(\Apra)\cap dom(\sigma_1)= \overline {v_1}$.\\
%$\SPS (15c) \ \  \fv(\Apra)  \setminus dom(\sigma_1) = \overline {v_2}$. \\
%Moreover, (12d) and (13d) give that\\
%$\SPS (15d) \ \  \fv(\Apra)  \setminus dom(\sigma_1) = \overline{z_2} = \overline {z}; \overline{v_6}$.
%
%
% \vspace{.3cm}
%Proving $(**)$. Assume that   $\leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma}  {\sigma'}$. Then, by the operational semantics, we obtain that 
%there exists state $\sigma_1'$, such that \\
%$\SPS (16) \ \ \leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma_1}  {\sigma_1'}$ \\
%$\SPS (17) \ \ \sigma'=(\sigma_1'\popSymbol)[u \mapsto {\interpret {\sigma_1'} {\prg{res}}}][\prg{cont}\mapsto \epsilon]$.
%\\
%We now apply the induction hypothesis on (14a), (16), (15d), and obtain
%\\ 
%$\SPS (18) \ \  \satDAssertFrom M  {\sigma_1'} {\npgreen{\DepthSt {\sigma_1} }}    {(\Apoa)[\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]}$.
%\\
%We now want to obtain something of the form $...\sigma' \models ...A'$. For this, we  want to be able to apply   Lemma \ref{l:calls:return},  \npgreen{part \ref{l:calls:caller:two}} on (18). Therefore, we  define
%\\
%$\SPS (18a) \ \  \Aout \triangleq  A_{post}[\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]$
%\\
%$\SPS (18b) \ \  \overline {v_{1,a}} \triangleq  \overline {v_1}, \prg{res}$,   \ \ \ \ 
%$\overline {v_{3,a}} \triangleq  \overline {v_3}, u$,   \ \ \ \ $\npgreen{\overline{v_5}  \triangleq  \overline {v_3} }$
%\\
%The wellformedness condition for specifications requires that $\fv (A_{post}) \subseteq  \fv (\Apr) \cup \{ \prg{res} \}$. 
%This, together with  (9), (12d) and (18b) give  \\
%$\SPS (19a) \ \  \fv(\Aout) \subseteq  \overline {v_{1,a}}$
%\\
%Also, by (18b), and (17), we have that   
%\\
%$\SPS (19b) \ \ \overline {\interpret {\sigma'} {v_{3,a}}  =  \interpret {\sigma_1'} {v_{1,a}} }$.
%\\
% From (16) we obtain that  $ \DepthSt {\sigma_1'} = \DepthSt {\sigma_1}$. This, together with (18) gives 
%  \\
%$\SPS (19c) \ \  \npgreen{ M , {\sigma_1'} \models  {(\Apoa)[\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]}}$.
%\\
%\npgreen{From (16), (18b) and by the fact that we never overwrite the values of the formal parameters, we have that  
%$\overline{ \interpret {\sigma} {v_5}}$=$\overline{\interpret {\sigma_1} {v_1}}$=$\overline{\interpret {\sigma_1'} {v_1}}$=$\overline{\interpret {\sigma'} {v_5}}$,
%and this also gives that}
%\\
%$\SPS (19d) \ \  \npgreen{  \overline{\interpret {\sigma'} {v_5}} \subseteq  \LRelevantO {\sigma_1'} }$
%\\
%We now apply  Lemma \ref{l:calls:return},  part \ref{l:calls:caller:two}, and obtain  
%\\
%$\SPS (20) \ \   \npgreen{ M,  {\sigma'} \models   {\PushASLongG {({\overline {v_3}}) }  {\Aout[\overline{v_{3,a}/v_{1,a}}] } } }$.
%\\
%\npgreen{Adaptation gives stable assertions - \cf lemma \ref{l:adapt:stable}.Moreover, any stable assertion which holds 
%at the top-most scope (frame) also holds at any earlier scope (frame) -- \cf lemma \ref{l:shallow:scoped}, part \ref{shallow:to:scoped}.}
%Therefore, (20) also gives \\
%$\SPS (20a) \ \   \npgreen{  \satDAssertFrom M  {\sigma'} {k}  {\PushASLongG {({\overline {v_3}}) }  {\Aout[\overline{v_{3,a}/v_{1,a}}] } } }$. 
%\\
%We expand the definition from (18a), and re-order the substitutions by a similar argument as in in step (13a), using Lemma    part (\ref{l:sfs:six}), and obtain\\
%$\SPS (20b) \ \  \satDAssertFrom M  {\sigma'} {k}   {\PushASLongG {({\overline {v_3}})}  {A_{post}[\overline{v_{3,a}/v_{1,a}}][\overline{\alpha/z}][\overline{\interpret {\sigma} {v_6} /v_6}]}}$.
%\\
%By Lemma \ref{l:var:unaffect} we have that $\overline{\interpret {\sigma} {v_6}}$=$\overline{\interpret {\sigma'} {v_6}}$, and so we  obtain\\
%$\SPS (20c) \ \  \satDAssertFrom M  {\sigma'} {k}   {\PushASLongG {({\overline {v_3}})}  {A_{post}[\overline{v_{3,a}/v_{1,a}}][\overline{\alpha/z}]}}$.
%\\
%Moreover, $\overline {v_3} \# \overline z$. We apply lemma \ref{l:sybbs:adapt}, and obtain:\\
%$\SPS (20d) \ \  \satDAssertFrom M  {\sigma'} {k}   { (\PushASLongG {({\overline {v_3}})}  {A_{post}[\overline{v_{3,a}/v_{1,a}}]} ) [\overline{\alpha/z}] }$.
%\\
%By  (20d),   (18b),  we  obtain
%\\
%$\SPS (21) \ \  \satDAssertFrom M  {\sigma'} {k}   {( \PushASLongG {(y_0,\overline y)}  {A_{post}[y_0,\overline y,u/\prg{this},\overline{x},\prg{res}]} ) [\overline{\alpha/z}]  }$.
%\\
%With (7) we conclude.\\
%~ \\
%
% \vspace{.3cm}
%Proving $(*\!*\!*)$. This is similar to the proof for {\sc{Call\_Int}}.
%\\
%~ \\

\newcommand{\Ainv}{A_{inv}}
\newcommand{\Ainva}{A_{inva}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% HERE %%%%%%%%%
\item[{\sc{Call\_Ext\_Adapt}}] is  in some parts, similar to {\sc{Call\_Int}}. % , and {\sc{Call\_Int\_Adaprt}}.
We highlight the differences in \npgreen{green}.

Therefore, there exist $u$, $y_o$, $\overline C$, $D$, $\overline y$, ands $\Ainv$, such that \\
 $\SPS (5) \ \ \sigma.\prg{cont}\txteq u:=y_0.m(\overline y)$,\\
% $\SPS (5a) \ \ \{ u, y_0, ... y_n \}  \subseteq \overline w $, \ \ $\overline z \cap  \{ u, y_0, ... y_n \}  = \emptyset$ \\ 
$\SPS (6) \  \ \npgreen{\promises  M {\TwoStatesN {\overline {x:C}} {\Ainv} } }$, \\
$\SPS (7) \  \ A \txteq y_0:\prg{external} ,\overline {x:C}\ \wedge \  \PushASLongG {({y_0, \overline y})} {\npgreen{\Ainv}} ,$ \\
$\SPS \ \ \ \ \ \ \ A'  \txteq \PushASLongG {(y_0, \overline y)} {\npgreen{\Ainv}}$,\\
$\SPS\ \ \ \ \ \  \  A'' \txteq \npgreen{\Ainv}$. 
\\
Also, \\
$\SPS (8) \ \ \leadstoBounded  {\Mtwo\cdot M}  {\sigma}  {\sigma_a}$, \\
where \\
$\SPS (8a) \ \ \ \sigma_a\triangleq (\PushSLong { (\prg{this}\mapsto {\interpret{\sigma} {y_0}},{\overline{p \mapsto {\interpret{\sigma} {y}}}})}\sigma [\prg{cont}\mapsto stmt_m]$, \\ 
$\SPS (8b) \ \ \   \prg{mBody}(m,D,\overline {M})=\overline{p:D}\{\    stmt_m\ \}$ .\\
%where\\
$\SPS (8c) \ \ \  \npgreen{D\ \mbox{is the class of}\, \interpret  {\sigma} {y_0}, \ \mbox{and $D$ is external.}}$
\\
By (7), and well-formedness of module invariants, we obtain\\
$\SPS (9a) \ \ \ \npgreen{\fv(\Ainv)\subseteq  \overline x}$,\\
$\SPS (9a) \ \ \ \npgreen{\fv(A)=y_0,\overline y, \overline x}$\\
\npgreen{By Barendregt, we also obtain that}\\
$\SPS (10) \ \ \ \npgreen{dom(\sigma)\ \#  \overline{x}}$
\\
This, together with (3) gives that
\\
$\SPS (10) \ \ \ \npgreen{\overline z = \overline x}$
\\
From (4), (7) and the definition of satisfaction we obtain\\
$\SPS (10) \ \ \ \npgreen{\satDAssertFrom M  {\sigma} k {(\overline{x:C} \wedge {\PushSLong {y_0,\overline y} {\Ainv}})[\overline{\alpha/z}]}}$.\\
The above gives that\\
$\SPS (10a) \ \ \ \npgreen{\satDAssertFrom M  {\sigma} k {\PushSLong {y_0,\overline y} {(\ (\overline{x:C})[\overline{\alpha/z}]\, \wedge\,  ( {\Ainv[\overline{\alpha/z}]}) \ ) } } }$  .
\\
We take $\Ain$ to be $\ (\overline{x:C})[\overline{\alpha/z}]\, \wedge\,  ( {\Ainv[\overline{\alpha/z}]})$, and apply Lemma \ref{l:calls:external},
part \ref{l:calls:callee:one}.
This gives that
\\
$\SPS (11)\ \ \npgreen{ M,  {\sigma_a} \models   {(\overline{x:C})[\overline{\alpha/z}]\, \wedge\,    {\Ainv[\overline{\alpha/z}]}  } }$

\vspace{.3cm}

Proving $(**)$. We shall use the short hand\\
$\SPS (12) \ \  \npgreen{\Ao \triangleq  \overline {\alpha:C} \wedge {\Ainv[\overline{\alpha/z}]}}$. 
\\
Assume that   $\leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma}  {\sigma'}$. Then, by the operational semantics, we obtain that 
there exists state $\sigma_b'$, such that \\
$\SPS (16) \ \ \leadstoBoundedStarFin  {\Mtwo\cdot M}  {\sigma_a}  {\sigma_b}$ \\
$\SPS (17) \ \ \sigma'=(\sigma_b\popSymbol)[u \mapsto {\interpret {\sigma_1'} {\prg{res}}}][\prg{cont}\mapsto \epsilon]$.
\\
\npgreen{By Lemma \ref{lemma:external_breakdown:term} part \ref{lemma:external_breakdown:term:one}, and Def. \ref{def:exec:sum}, we obtain that there exists a sequence of states $\sigma_1$, ... $\sigma_n$, such that }\\
$\SPS (17) \ \ \npgreen{\WithExtPub {\Mtwo\cdot M} {\sigma_a}  {\sigma_a}  {\sigma_b} {\sigma_1...\sigma_n}}$
\\
\npgreen{By Def.   \ref{def:exec:sum}, the states $\sigma_1$, ... $\sigma_n$ are all public, and  correspond to the execution of a public method.
Therefore, by rule {\sc{Invariant}} for well-formed modules, we obtain that}\\
\newcommand{\Ainvr}{A_{inv,r}}
$\SPS (18) \ \ \npgreen{\forall i\in 1..n. }$\\
$ \npgreen{\strut\ \ \ \  \ \ \ \ \ \ \ \ 
    [ \  \hprovesN {M}  
               {   \prg{this}: {D_i}, \overline{p_i:D_i},  \overline{x:C} \, \wedge\,  \Ainv  }   
  	      { \sigma_i.\prg{cont}  }   
	      {  \Ainvr  }
	      { \Ainv  }
	     \  ] 
	     }
	     $ 
\\
\npgreen{where $D_i$ is the class of the receiver, $\overline{p_i}$ are the formal parameters, and $\overline {D_i}$ are the types of the formal parameters of the $i$-th public method, and where we use the shorthand $\Ainvr \triangleq  \PushASLong {\prg{res}} { \Ainv } $.}
\\ 
\npgreen{Moreover, (17) gives that}\\
$\SPS (19) \ \ \npgreen{\forall i\in 1..n. [ \ \  \ \leadstoBoundedStar {M\cdot\Mtwo} {\sigma} {\sigma_i} \ \ \ ]}$
\\
\npgreen{From (18) and (19) we obtain}\\
 $\SPS (20) \ \ \npgreen{\forall i\in [1..n]. }$\\
 ${\npgreen{
 \strut \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [ \ \     (  \prg{this}:D_i, \overline{p_i:D_i},\overline{x:C} \, \wedge\,  \Ainv,\sigma_i,\Ainvr, \Ainv ) }}$\\
 ${\npgreen{
 \strut \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \  \ \ \ \ \ \ \ \ \    \ll_{M,\Mtwo} }}$\\
 ${\npgreen{
 \strut \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \   \ \ \ \ \ \ \ \ \   ( A,\sigma,A',A'') \ \
                                        ]}}
                                      $
 \\
We take \\
$\SPS (21) \ \ k=\DepthSt {\sigma_a}$
 By application of the induction hypothesis on (20) we obtain that
\\
 $\SPS (22) \ \ \npgreen{\forall i\in [1..n]. \forall \sigma_{f}.[ \ \  \satDAssertFrom M {\sigma_i} k \Ao  \ \wedge \  \leadstoBoundedStarFin {M\cdot \Mtwo}  {\sigma_i}  {\sigma_{f}} \ 
\ \ \Longrightarrow \ \  \satDAssertFrom M {\sigma_f} k \Ao \ ]}$ 
\\
\npgreen{We can now apply Lemma \ref{lemma:external_exec_preserves_more}, part \ref{lemma:external_exec_preserves_more:three}, and because  $\DepthSt {\sigma_a}=\DepthSt {\sigma_b}$, we obtain that}
\\
 $\SPS (23) \ \ \npgreen{M, \sigma_b \models \Ainv[\overline{\alpha/x} ]} $ %{\satDAssertFrom M {\sigma_b} k \Ao }$
 \\
We apply Lemma  \ref{l:calls:return:ext} part \ref{l:ext:return:one}, and obtain
 \\
  $\SPS (24) \ \  M, \sigma' \models {\PushASLong {y_0,\overline y} {\Ainv[\overline{\alpha/x} ] }} $
  \\
  And since  ${\PushASLong {y_0,\overline y} {\Ainv[\overline{\alpha/x} ] }}$ is stable, and by rearranging, and applying (10), we obtain
 \\
   $\SPS (25) \ \   \satDAssertFrom M  {\sigma'} k   { (\PushASLong {y_0,\overline y} {\Ainv})[\overline{\alpha/z}] }$
\\  
Apply (7), and  we are done.
 
 \vspace{.3cm}

Proving   $(*\!*\!*)$. Take a $\sigma''$. Assume that\\
$\SPS (12) \ \ \leadstoBoundedStar   {\Mtwo\cdot M}  {\sigma}  {\sigma''}$\\
$\SPS (13) \ \ \ {\Mtwo\cdot M}, \sigma'' \models \extThis$.\\
We apply lemma \ref{lemma:external_breakdown:term:one}, part \ref{lemma:external_breakdown:two}
on (12) and see that there are two cases\\
\textbf{1st Case} $\leadstoBoundedExtPub {\Mtwo\cdot M}    {\sigma_a}  {\sigma''}$\\
That is, the execution from $\sigma_a$ to $\sigma''$ goes only through external states. 
We use (11), and that 
 $\Ainv$ is encapsulated, and are done with lemma \ref{lemma:external_exec_preserves_more}, part 
 \ref{lemma:external_exec_preserves_more:one}.
\\
\textbf{2nd Case} for some  $\sigma_c$, $\sigma_d.$ we have\\
$
\strut \ \ \ \ \ \leadstoBoundedExtPub {\Mtwo\cdot M}    {\sigma_a}  {\sigma_c} 
\wedge\ \leadstoBounded  {\Mtwo\cdot M}    {\sigma_c}  {\sigma_d} 
\wedge \ M, \sigma_d \models \pubMeth \wedge \leadstoBoundedStar  {\Mtwo\cdot M}    {\sigma_d}  {\sigma'}$\\
We apply similar arguments as in steps (17)-(23) and obtain \\
$\SPS (14) \ \ \ \ {M, \sigma_c \models \Ainv[\overline{\alpha/x} ]} $ 
\\
State $\sigma_c$ is a public, internal state;  therefore there exists a Hoare proof that it preserves the invariant.
By applying the inductive hypothesis, and the fact that $\overline z = \overline x$, we obtain:
\\
$\SPS (14) \ \ \ \ {M, \sigma'' \models \Ainv[\overline{\alpha/z} ]} $
\\
~ \\

\item[{\sc{Call\_Ext\_Adapt\_Strong}}] is  very similar to {\sc{Call\_Ext\_Adaprt}}.
We will summarize the similar steps, and highlight the differences in \npgreen{green}.

Therefore, there exist $u$, $y_o$, $\overline C$, $D$, $\overline y$, ands $\Ainv$, such that \\
 $\SPS (5) \ \ \sigma.\prg{cont}\txteq u:=y_0.m(\overline y)$,\\
% $\SPS (5a) \ \ \{ u, y_0, ... y_n \}  \subseteq \overline w $, \ \ $\overline z \cap  \{ u, y_0, ... y_n \}  = \emptyset$ \\ 
$\SPS (6) \  \ \npgreen{\promises  M {\TwoStatesN {\overline {x:C}} {\Ainv} } }$, \\
$\SPS (7) \  \ A \txteq y_0:\prg{external} ,\overline {x:C}\ \wedge \ \npgreen{\Ainv}\  \wedge \PushASLongG {({y_0, \overline y})} {{\Ainv}} ,$ \\
$\SPS \ \ \ \ \ \ \ A'  \txteq  \npgreen{\Ainv}\  \wedge \PushASLong {(y_0, \overline y)} {\npgreen{\Ainv}}$,\\
$\SPS\ \ \ \ \ \  \  A'' \txteq  {\Ainv}$. 
\\
Also, \\
$\SPS (8) \ \ \leadstoBounded  {\Mtwo\cdot M}  {\sigma}  {\sigma_a}$, \\
By similar steps to (8a)-(10) from the previous case, we obtain\\
$\SPS (10a) \ \ \ \   \satDAssertFrom M  {\sigma} k {\npgreen{{\Ainv[\overline{\alpha/z}]} \wedge \ \PushSLong {y_0,\overline y} {(\ (\overline{x:C})[\overline{\alpha/z}]\, \wedge\,  ( {\Ainv[\overline{\alpha/z}]}) \ ) } } }$.\\
We now apply lemma  apply Lemma \ref{l:calls:external},
part \ref{l:calls:callee:two}.
This gives that
\\
$\SPS (11)\ \   \satDAssertFrom M  {\sigma_a} {\npgreen{k}} { (\ \ (\overline{x:C})[\overline{\alpha/z}] \, \wedge\,    \npgreen{\Ainv[\overline{\alpha/z}]} \wedge \ \PushSLong {y_0,\overline y} {(\ (\overline{x:C})[\overline{\alpha/z}] )} \ \ ) }$.
\\
the rest is similar to earlier cases
 
\vspace{.3cm}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\end{description}
\noindent
\vspace{.1cm}
  {\textbf{End Proof}} 

\subsection{Proof Sketch of Theorem  \ref{thm:soundness} -- part (B)}

\label{s:app:proof:sketch;overall}
 {\textbf{Proof Sketch}}
 By induction on the  cases for the specification $S$. If it is a method spec, then the theorem follows from \ref{t:quadruple:sound}. If it is a conjunction, then by inductive hypothesis.
 \\
 The interesting case is $S \txteq {\TwoStatesN {\overline {x:C}} {A}}$.
 \\
 Assume that 
 $ \satDAssertFrom M  {\sigma} k A[\overline {\alpha/x} ]$, that  $M,\sigma \models \extThis$,
 that $\leadstoBoundedStar  {M\cdot \Mtwo}  {\sigma}  {\sigma'}$, and that $M,\sigma \models \extThis$,
 \\ 
 We want to show that $ \satDAssertFrom M  {\sigma'} k A[\overline {\alpha/x} ]$.
 \\
 Then, by lemma
 \ref{lemma:external_breakdown:term}, we obtain that either \\
$\strut \ \ \ \ \ $ (1)\  $\leadstoBoundedExtPub {\Mtwo\cdot M}    {\sigma}  {\sigma'}$, or\\
$\strut \ \ \ \ \ $  (2)\  $\exists \sigma_1,\sigma_2.[\
\leadstoBoundedExtPub {\Mtwo\cdot M}    {\sigma}  {\sigma_1}
\wedge\ \leadstoBounded  {\Mtwo\cdot M}    {\sigma_1}  {\sigma_2}
\wedge \ M, \sigma_2 \models \pubMeth \wedge \leadstoBoundedStar  {\Mtwo\cdot M}    {\sigma_2}  {\sigma'} \ ]$
\\
In Case (1), we apply  \ref{lemma:external_exec_preserves_more}, part (3).  In order to fulfill the second premise of Lemma  \ref{lemma:external_exec_preserves_more}, part (3), we make use of the fact that $\vdash M$,   apply the rule {\sc{Method}}, and theorem \ref{t:quadruple:sound}.
This gives us $ \satDAssertFrom M  {\sigma'} k A[\overline {\alpha/x} ]$
\\
In Case (2), we proceed as in (1) and obtain that $ \satDAssertFrom M  {\sigma_1} k A[\overline {\alpha/x} ]$. Because $M \vdash \encaps A$, we also obtain that 
$ \satDAssertFrom M  {\sigma_2} k A[\overline {\alpha/x} ]$.
Since we are now executing a public method, and because $\vdash M$, we can apply {\sc{Invariant}}, and theorem \ref{t:quadruple:sound}, and obtain $ \satDAssertFrom M  {\sigma'} k A[\overline {\alpha/x} ]$\\
 \vspace{.1cm}
  {\textbf{End Proof Sketch}} 