 \begin{abstract}
 
In today's complex software, internal, trusted, code % needs to cooperate with external code  of unknown provenance and trustworthiness.
is tightly intertwined  %cooperates 
with external, untrusted, code: external code may call into internal  code, and internal code may call out to external code.
% In particular, trusted  code may be called by external, unverified, untrusted code; moreover, it may call such external, unverified, untrusted code
This tight intertwining   introduces a high degree of uncertainty which developers strive to mitigate:
They %want to preserve   important properties of their data, and  
 want to prevent the external code %\susan{when calling into the internal code,} SD removed this bit -- not sure it helps
 from  
 causing certain effects unless it is ``entitled'' to.

The OCAP (object capabilities) model has proposed means to mitigate this uncertainty:
Capabilities are transferable rights to perform one or more operations on a given object.
Thus, capabilities \emph{enable} effects.  
But even more: % strongly than that:  
Capabilities \emph{guard} effects: callers can make the effect   happen, only if they have access to the corresponding capability.
%Capabilities are unforgeable, and can only be acquired through explicit passing from caller to callee, or at object creation.
  As a result, sharing of capabilities has to be carefully managed.
%
Our work addresses the specification and verification of code which relies on capabilities as guards.

% -- something not yet sufficiently  tackled by the OCAP  literature.
{\textbf {For the specification:}} To describe
 not being ``entitled'' to some effect, we give a means to guarantee  that lack of (eventual) access to certain capabilities ensures
that certain effects will not take place.
 To reflect that the guarantees
should hold in the presence of internal code calling and being called by external code, we 
% are about eventual} effects we 
propose \susan{\emph{scoped invariants}}, where the notion of the future is \susan{constrained} by the currently executing method. 
%We propose means to specify the preservation of such properties, and the meaning of being ``entitled'' to some effect. 
To define the   management of sharing of capabilities, we propose the concept of  protected capability which guarantees  that access by external objects
 is controlled by the internal objects.
  
%  
%  Our specification language can express that capabilities are necessary (rather than sufficient) conditions for certain effects
%(thus going further than traditional object capabilities).
% We propose 
% With these ingredients, internal code may call external code in the knowledge that ...
{\textbf {For the verification: }} We  propose Hoare logic inference rules  \sdN{to prove} that calls to external code are safe. 
We also propose inference rules  \sdN{to prove}    that  {our} modules satisfy our specifications.
We then \sdN{demonstrate}  that a sound   Hoare logic augmented by the proposed rules is also sound. 
We use a motivating example  and   prove its properties using our logic.


\end{abstract}

